import{ad as J,ae as K,D as $,af as j,Y as X,S as Z,j as G,a8 as ee,d as te,aa as le,r as h,ag as U,a5 as ae,c as oe,a as e,w as t,o as ne,b as x,i as D,l as se,_ as ue}from"./index-BX2sZVyW.js";import{E as re,a as ie}from"./tab-pane-BLMCB6bP.js";import{E as de,a as me}from"./col-DfCBUvxB.js";import{E as pe}from"./statistic-BIQ42bG3.js";import{E as fe}from"./card-B6phTZGW.js";import{E as ce,a as _e}from"./form-item-BCUJoI1X.js";import{E as ve}from"./button-Cn9gqGCu.js";import{E as ge,b as Te}from"./radio-group-DyO9WxrE.js";import{E as be}from"./date-picker-CMS_m3WO.js";import"./input-5aB7ALv6.js";import"./scrollbar-C9NSq6wy.js";/* empty css            */import{E as we,a as ye}from"./select-9k77N6f3.js";import"./divider-Cw9FL3-C.js";import{E as xe}from"./page-header-BYBfeuC8.js";import{i as z}from"./index-C3W-oE5n.js";import"./strings-JcT2fde-.js";import"./event-BORzi4vc.js";import"./index-Dc9GAbAN.js";import"./_baseClone-BOpOh07B.js";import"./isPlainObject-jZyBOBeK.js";import"./index-PwB6y63X.js";import"./index-BDj3Pv7k.js";import"./debounce-DYp1oJWc.js";import"./isEqual-ohjdCfDM.js";import"./index-BFcHm1-Q.js";import"./scroll-g5r06U3K.js";function Pe(c){return J()?(K(c),!0):!1}const ke=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const he=ke?window:void 0;function L(c){var o;const r=j(c);return(o=r==null?void 0:r.$el)!=null?o:r}function Ee(){const c=Z(!1),o=ee();return o&&G(()=>{c.value=!0},o),c}function Oe(c){const o=Ee();return $(()=>(o.value,!!c()))}function Re(c,o,r={}){const{window:E=he,...O}=r;let _;const P=Oe(()=>E&&"ResizeObserver"in E),k=()=>{_&&(_.disconnect(),_=void 0)},R=$(()=>{const n=j(c);return Array.isArray(n)?n.map(s=>L(s)):[L(n)]}),d=X(R,n=>{if(k(),P.value&&E){_=new ResizeObserver(o);for(const s of n)s&&_.observe(s,O)}},{immediate:!0,flush:"post"}),i=()=>{k(),d()};return Pe(i),{isSupported:P,stop:i}}const Se={class:"performance-monitoring-page"},Ve=te({__name:"performance-monitoring",setup(c){const o=le({organization:"",model:"",dateRange:[new Date(new Date().getTime()-864e5),new Date],granularity:"hour"}),r=h({totalCalls:125890,failedCalls:124,failureRate:.1,totalTokens:45892100,inputTokens:1245e4,outputTokens:33442100,p95TTFT:245,p95TPOT:32,p95Latency:1850,p95OTPS:35}),E=h("ttft"),O=h(null),_=h(null),P=h(null),k=h(null),R=h(null);let d=null,i=null,n=null,s=null,m=null;const I=p=>{const l=[],w=new Date;for(let u=0;u<p;u++){const v=new Date(w.getTime()-(p-u)*60*60*1e3);l.push(`${v.getHours().toString().padStart(2,"0")}:${v.getMinutes().toString().padStart(2,"0")}`)}return l},a=(p,l,w)=>{const u=[];for(let v=0;v<p;v++)u.push(Math.floor(l+Math.random()*w-w/2));return u},S=(p,l,w,u)=>{const v=Object.keys(u).map(y=>({name:y,type:"line",smooth:!0,symbol:"none",data:u[y],emphasis:{focus:"series"}}));return{title:{text:""},tooltip:{trigger:"axis"},legend:{data:Object.keys(u),bottom:0},grid:{left:"3%",right:"4%",bottom:"10%",top:"5%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:w},yAxis:{type:"value",name:l},series:v}},M=()=>{const p=I(24);O.value&&!d&&(d=z(O.value),d.setOption(S("TTFT趋势","ms",p,{Avg:a(24,150,50),P50:a(24,140,40),P90:a(24,200,60),P95:a(24,250,80),P99:a(24,350,100)}))),_.value&&!i&&(i=z(_.value),i.setOption(S("OTPS趋势","tokens/s",p,{Avg:a(24,45,10),P50:a(24,48,8),P90:a(24,35,10),P95:a(24,30,10),P99:a(24,20,10)}))),P.value&&!n&&(n=z(P.value),n.setOption(S("TPOT趋势","ms/token",p,{Avg:a(24,25,5),P50:a(24,22,4),P90:a(24,30,6),P95:a(24,35,8),P99:a(24,45,10)}))),k.value&&!s&&(s=z(k.value),s.setOption(S("端到端延迟","ms",p,{Avg:a(24,1200,300),P50:a(24,1e3,200),P90:a(24,1800,400),P95:a(24,2200,500),P99:a(24,3e3,800)}))),R.value&&!m&&(m=z(R.value),m.setOption(S("TPM趋势","tokens",p,{Total:a(24,5e4,1e4),Input:a(24,15e3,5e3),Output:a(24,35e3,8e3)})))},W=()=>{U(()=>{A()})},A=()=>{d==null||d.resize(),i==null||i.resize(),n==null||n.resize(),s==null||s.resize(),m==null||m.resize()},N=()=>{se.success("查询成功，数据已更新"),d==null||d.dispose(),i==null||i.dispose(),n==null||n.dispose(),s==null||s.dispose(),m==null||m.dispose(),d=null,i=null,n=null,s=null,m=null,M()};return Re([O,_,P,k,R],()=>{A()}),G(()=>{U(()=>{M()})}),ae(()=>{d==null||d.dispose(),i==null||i.dispose(),n==null||n.dispose(),s==null||s.dispose(),m==null||m.dispose()}),(p,l)=>{const w=xe,u=ye,v=we,y=_e,C=be,B=Te,H=ge,q=ve,Q=ce,f=fe,g=pe,T=me,F=de,V=ie,Y=re;return ne(),oe("div",Se,[e(w,{onBack:l[0]||(l[0]=b=>p.$router.back())},{content:t(()=>l[6]||(l[6]=[x("span",{class:"text-2xl font-bold"},"性能监控",-1)])),_:1}),e(f,{class:"mt-4"},{default:t(()=>[e(Q,{inline:!0,model:o},{default:t(()=>[e(y,{label:"组织"},{default:t(()=>[e(v,{modelValue:o.organization,"onUpdate:modelValue":l[1]||(l[1]=b=>o.organization=b),placeholder:"全部组织",clearable:"",style:{width:"160px"}},{default:t(()=>[e(u,{label:"研发部",value:"dev"}),e(u,{label:"市场部",value:"marketing"}),e(u,{label:"产品部",value:"product"})]),_:1},8,["modelValue"])]),_:1}),e(y,{label:"模型服务"},{default:t(()=>[e(v,{modelValue:o.model,"onUpdate:modelValue":l[2]||(l[2]=b=>o.model=b),placeholder:"全部模型",clearable:"",style:{width:"160px"}},{default:t(()=>[e(u,{label:"Qwen2.5-72B",value:"qwen"}),e(u,{label:"DeepSeek-V3",value:"deepseek"}),e(u,{label:"Llama-3-70B",value:"llama"})]),_:1},8,["modelValue"])]),_:1}),e(y,{label:"时间范围"},{default:t(()=>[e(C,{modelValue:o.dateRange,"onUpdate:modelValue":l[3]||(l[3]=b=>o.dateRange=b),type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间",style:{width:"340px"}},null,8,["modelValue"])]),_:1}),e(y,{label:"时间粒度"},{default:t(()=>[e(H,{modelValue:o.granularity,"onUpdate:modelValue":l[4]||(l[4]=b=>o.granularity=b)},{default:t(()=>[e(B,{label:"minute"},{default:t(()=>l[7]||(l[7]=[D("分钟",-1)])),_:1,__:[7]}),e(B,{label:"hour"},{default:t(()=>l[8]||(l[8]=[D("小时",-1)])),_:1,__:[8]}),e(B,{label:"day"},{default:t(()=>l[9]||(l[9]=[D("天",-1)])),_:1,__:[9]})]),_:1},8,["modelValue"])]),_:1}),e(y,null,{default:t(()=>[e(q,{type:"primary",onClick:N},{default:t(()=>l[10]||(l[10]=[D("查询",-1)])),_:1,__:[10]})]),_:1})]),_:1},8,["model"])]),_:1}),e(F,{gutter:16,class:"mt-4"},{default:t(()=>[e(T,{xs:12,sm:8,md:4},{default:t(()=>[e(f,{shadow:"hover",class:"metric-card"},{default:t(()=>[e(g,{title:"总调用次",value:r.value.totalCalls},null,8,["value"])]),_:1})]),_:1}),e(T,{xs:12,sm:8,md:4},{default:t(()=>[e(f,{shadow:"hover",class:"metric-card"},{default:t(()=>[e(g,{title:"失败次",value:r.value.failedCalls,"value-style":"color: var(--el-color-danger)"},null,8,["value"])]),_:1})]),_:1}),e(T,{xs:12,sm:8,md:4},{default:t(()=>[e(f,{shadow:"hover",class:"metric-card"},{default:t(()=>[e(g,{title:"失败率",value:r.value.failureRate,suffix:"%"},null,8,["value"])]),_:1})]),_:1}),e(T,{xs:12,sm:8,md:4},{default:t(()=>[e(f,{shadow:"hover",class:"metric-card"},{default:t(()=>[e(g,{title:"总Token",value:r.value.totalTokens},null,8,["value"])]),_:1})]),_:1}),e(T,{xs:12,sm:8,md:4},{default:t(()=>[e(f,{shadow:"hover",class:"metric-card"},{default:t(()=>[e(g,{title:"输入Token",value:r.value.inputTokens},null,8,["value"])]),_:1})]),_:1}),e(T,{xs:12,sm:8,md:4},{default:t(()=>[e(f,{shadow:"hover",class:"metric-card"},{default:t(()=>[e(g,{title:"输出Token",value:r.value.outputTokens},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(F,{gutter:16},{default:t(()=>[e(T,{xs:12,sm:8,md:6},{default:t(()=>[e(f,{shadow:"hover",class:"metric-card"},{default:t(()=>[e(g,{title:"TTFT P95",value:r.value.p95TTFT,suffix:"ms"},null,8,["value"])]),_:1})]),_:1}),e(T,{xs:12,sm:8,md:6},{default:t(()=>[e(f,{shadow:"hover",class:"metric-card"},{default:t(()=>[e(g,{title:"TPOT P95",value:r.value.p95TPOT,suffix:"ms"},null,8,["value"])]),_:1})]),_:1}),e(T,{xs:12,sm:8,md:6},{default:t(()=>[e(f,{shadow:"hover",class:"metric-card"},{default:t(()=>[e(g,{title:"Latency P95",value:r.value.p95Latency,suffix:"ms"},null,8,["value"])]),_:1})]),_:1}),e(T,{xs:12,sm:8,md:6},{default:t(()=>[e(f,{shadow:"hover",class:"metric-card"},{default:t(()=>[e(g,{title:"OTPS P95",value:r.value.p95OTPS,suffix:"tokens/s"},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(f,{class:"mt-4"},{header:t(()=>l[11]||(l[11]=[x("div",{class:"flex justify-between items-center"},[x("h3",{class:"font-bold m-0"},"性能指标趋势")],-1)])),default:t(()=>[e(Y,{modelValue:E.value,"onUpdate:modelValue":l[5]||(l[5]=b=>E.value=b),onTabChange:W},{default:t(()=>[e(V,{label:"TTFT (首字延迟)",name:"ttft"},{default:t(()=>[x("div",{ref_key:"ttftChartRef",ref:O,style:{width:"100%",height:"450px"}},null,512)]),_:1}),e(V,{label:"OTPS (输出吞吐)",name:"otps"},{default:t(()=>[x("div",{ref_key:"otpsChartRef",ref:_,style:{width:"100%",height:"450px"}},null,512)]),_:1}),e(V,{label:"TPOT (单Token耗时)",name:"tpot"},{default:t(()=>[x("div",{ref_key:"tpotChartRef",ref:P,style:{width:"100%",height:"450px"}},null,512)]),_:1}),e(V,{label:"端到端延迟",name:"latency"},{default:t(()=>[x("div",{ref_key:"latencyChartRef",ref:k,style:{width:"100%",height:"450px"}},null,512)]),_:1}),e(V,{label:"TPM (每分钟Token)",name:"tpm"},{default:t(()=>[x("div",{ref_key:"tpmChartRef",ref:R,style:{width:"100%",height:"450px"}},null,512)]),_:1})]),_:1},8,["modelValue"])]),_:1})])}}}),ot=ue(Ve,[["__scopeId","data-v-10b8e6e5"]]);export{ot as default};
