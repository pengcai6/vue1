import{d as ae,r as c,B as C,j as oe,c as ne,a as e,w as l,o as k,b as p,i as u,n as s,E as ue,k as ie,l as se,m as re}from"./index-DAZDpghP.js";import{E as de,a as pe}from"./descriptions-item-DIjWwK7N.js";import{E as me}from"./dialog-CI4qXYgt.js";import{E as fe,a as _e}from"./form-item-D50nbGgb.js";import{E as ve,a as ce}from"./radio-ChFPTsFt.js";import{E as ge}from"./slider-TZXgOp1o.js";import{E as Pe}from"./input-BsUoEHjr.js";import{E as Ue}from"./input-number-BUSsIkB9.js";/* empty css            */import{E as be,a as Ge}from"./select-B_Nc0zOl.js";import"./scrollbar-BKn1N4ug.js";import{a as ye,E as Ce}from"./table-column-CkszfM6q.js";import"./checkbox-DDntw5na.js";import{E as Ee}from"./popover--wAAUrH1.js";import{E as Ve}from"./button-CFFx6FdR.js";import{E as Ne}from"./progress-CA3fGClE.js";import{E as xe,a as Te}from"./col-1pbAQj7U.js";import{E as we}from"./statistic-CqMGJr7U.js";import{E as Ie}from"./card-_e8Y2itV.js";import{E as De}from"./index-i9SNigSW.js";import"./event-D5_Wo8Xc.js";import"./scroll-PXqKi88e.js";import"./index-17xiCnpu.js";import"./_baseClone-BBryStzM.js";import"./debounce-Bv_84CHO.js";import"./index-BBjiecLk.js";import"./strings-BN0-5NCg.js";import"./isEqual-DlB8YXyV.js";import"./_baseIteratee-DgY2c_zD.js";import"./isPlainObject-CnEW4LJ3.js";const ke={class:"resource-pool-page p-5"},ze={class:"flex items-center justify-between"},Ae={class:"flex items-center justify-between"},Be={class:"flex items-center gap-2"},Se={class:"text-green-600 font-bold"},_l=ae({__name:"resource-pool",setup(Fe){const z=()=>[{id:"1",nodeName:"gpu-node-01",gpuType:"NVIDIA A100",gpuCount:8,memoryPerGPU:80,utilization:75,status:"online",availableGPUs:2},{id:"2",nodeName:"gpu-node-02",gpuType:"NVIDIA H100",gpuCount:8,memoryPerGPU:80,utilization:60,status:"online",availableGPUs:3},{id:"3",nodeName:"gpu-node-03",gpuType:"昇腾 910B",gpuCount:8,memoryPerGPU:64,utilization:45,status:"online",availableGPUs:5},{id:"4",nodeName:"gpu-node-04",gpuType:"沐曦 C500",gpuCount:4,memoryPerGPU:64,utilization:30,status:"online",availableGPUs:3},{id:"5",nodeName:"gpu-node-05",gpuType:"海光 DCU",gpuCount:4,memoryPerGPU:32,utilization:20,status:"online",availableGPUs:4}],i=c([]),U=c(""),g=c(!1),E=c(!1),b=c(!1),r=c(null),n=c({nodeName:"",gpuType:"",gpuCount:4,memoryPerGPU:80,utilization:0,status:"online",availableGPUs:4}),A=C(()=>U.value?i.value.filter(o=>o.nodeName.toLowerCase().includes(U.value.toLowerCase())||o.gpuType.toLowerCase().includes(U.value.toLowerCase())):i.value),B=C(()=>i.value.reduce((o,t)=>o+t.gpuCount,0)),S=C(()=>i.value.reduce((o,t)=>o+t.availableGPUs,0)),F=C(()=>i.value.length===0?0:i.value.reduce((t,m)=>t+m.utilization,0)/i.value.length);function M(o){return o.includes("NVIDIA")?"success":o.includes("昇腾")?"warning":o.includes("沐曦")?"danger":o.includes("海光")?"info":""}function $(o){return o<30?"#67C23A":o<70?"#E6A23C":"#F56C6C"}function L(o){r.value=o,E.value=!0}function j(o){b.value=!0,n.value={...o},g.value=!0}function H(o){i.value=i.value.filter(t=>t.id!==o),V()}function O(){if(b.value&&n.value.id){const o=i.value.findIndex(t=>t.id===n.value.id);o!==-1&&(i.value[o]={...n.value})}else{const o={...n.value,id:Date.now().toString()};i.value.push(o)}V(),g.value=!1,R()}function R(){b.value=!1,n.value={nodeName:"",gpuType:"",gpuCount:4,memoryPerGPU:80,utilization:0,status:"online",availableGPUs:4}}function V(){localStorage.setItem("gpu-nodes",JSON.stringify(i.value))}function J(){const o=localStorage.getItem("gpu-nodes");o?i.value=JSON.parse(o):(i.value=z(),V())}return oe(()=>{J()}),(o,t)=>{const m=Ve,P=Ie,G=we,y=Te,q=xe,K=ie("i-ep-search"),Q=ue,T=Pe,d=Ce,N=De,W=Ne,X=Ee,Y=ye,_=_e,v=Ge,Z=be,x=Ue,h=ge,w=ce,ee=ve,le=fe,I=me,f=de,te=pe;return k(),ne("div",ke,[e(P,{class:"header-card"},{default:l(()=>[p("div",ze,[t[13]||(t[13]=p("div",null,[p("h2",{class:"text-2xl font-bold mb-2"},"资源池管理（异构加速器）"),p("p",{class:"text-gray-500"},"统一管理和调度异构GPU加速卡资源")],-1)),e(m,{type:"primary",onClick:t[0]||(t[0]=a=>g.value=!0)},{default:l(()=>t[12]||(t[12]=[u(" 添加GPU节点 ",-1)])),_:1,__:[12]})])]),_:1}),e(q,{gutter:20,class:"mt-4"},{default:l(()=>[e(y,{span:6},{default:l(()=>[e(P,null,{default:l(()=>[e(G,{title:"总节点数",value:i.value.length},null,8,["value"])]),_:1})]),_:1}),e(y,{span:6},{default:l(()=>[e(P,null,{default:l(()=>[e(G,{title:"总GPU卡数",value:B.value},null,8,["value"])]),_:1})]),_:1}),e(y,{span:6},{default:l(()=>[e(P,null,{default:l(()=>[e(G,{title:"可用GPU卡数",value:S.value,"value-style":{color:"#67C23A"}},null,8,["value"])]),_:1})]),_:1}),e(y,{span:6},{default:l(()=>[e(P,null,{default:l(()=>[e(G,{title:"平均利用率",value:F.value,suffix:"%",precision:1},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(P,{class:"mt-4"},{header:l(()=>[p("div",Ae,[t[14]||(t[14]=p("span",{class:"font-bold"},"GPU节点列表",-1)),e(T,{modelValue:U.value,"onUpdate:modelValue":t[1]||(t[1]=a=>U.value=a),placeholder:"搜索节点名称或GPU型号",style:{width:"300px"},clearable:""},{prefix:l(()=>[e(Q,null,{default:l(()=>[e(K)]),_:1})]),_:1},8,["modelValue"])])]),default:l(()=>[e(Y,{data:A.value,stripe:""},{default:l(()=>[e(d,{prop:"nodeName",label:"节点名称",width:"200"}),e(d,{prop:"gpuType",label:"GPU类型",width:"150"},{default:l(({row:a})=>[e(N,{type:M(a.gpuType)},{default:l(()=>[u(s(a.gpuType),1)]),_:2},1032,["type"])]),_:1}),e(d,{prop:"gpuCount",label:"GPU数量",width:"100",align:"center"}),e(d,{prop:"memoryPerGPU",label:"单卡显存",width:"120",align:"center"},{default:l(({row:a})=>[u(s(a.memoryPerGPU)+" GB ",1)]),_:1}),e(d,{prop:"totalMemory",label:"总显存",width:"120",align:"center"},{default:l(({row:a})=>[u(s(a.gpuCount*a.memoryPerGPU)+" GB ",1)]),_:1}),e(d,{label:"利用率",width:"180"},{default:l(({row:a})=>[p("div",Be,[e(W,{percentage:a.utilization,color:$(a.utilization),"show-text":!1},null,8,["percentage","color"]),p("span",null,s(a.utilization)+"%",1)])]),_:1}),e(d,{prop:"status",label:"状态",width:"100",align:"center"},{default:l(({row:a})=>[e(N,{type:a.status==="online"?"success":"danger"},{default:l(()=>[u(s(a.status==="online"?"在线":"离线"),1)]),_:2},1032,["type"])]),_:1}),e(d,{prop:"availableGPUs",label:"可用卡数",width:"100",align:"center"},{default:l(({row:a})=>[p("span",Se,s(a.availableGPUs),1),u(" / "+s(a.gpuCount),1)]),_:1}),e(d,{label:"操作",width:"200",fixed:"right"},{default:l(({row:a})=>[e(m,{link:"",type:"primary",onClick:D=>L(a)},{default:l(()=>t[15]||(t[15]=[u(" 详情 ",-1)])),_:2,__:[15]},1032,["onClick"]),e(m,{link:"",type:"warning",onClick:D=>j(a)},{default:l(()=>t[16]||(t[16]=[u(" 编辑 ",-1)])),_:2,__:[16]},1032,["onClick"]),e(X,{title:"确定要删除此节点吗？",onConfirm:D=>H(a.id)},{reference:l(()=>[e(m,{link:"",type:"danger"},{default:l(()=>t[17]||(t[17]=[u(" 删除 ",-1)])),_:1,__:[17]})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])]),_:1}),e(I,{modelValue:g.value,"onUpdate:modelValue":t[10]||(t[10]=a=>g.value=a),title:b.value?"编辑GPU节点":"添加GPU节点",width:"600px"},{footer:l(()=>[e(m,{onClick:t[9]||(t[9]=a=>g.value=!1)},{default:l(()=>t[20]||(t[20]=[u("取消",-1)])),_:1,__:[20]}),e(m,{type:"primary",onClick:O},{default:l(()=>t[21]||(t[21]=[u("保存",-1)])),_:1,__:[21]})]),default:l(()=>[e(le,{model:n.value,"label-width":"120px"},{default:l(()=>[e(_,{label:"节点名称"},{default:l(()=>[e(T,{modelValue:n.value.nodeName,"onUpdate:modelValue":t[2]||(t[2]=a=>n.value.nodeName=a),placeholder:"请输入节点名称"},null,8,["modelValue"])]),_:1}),e(_,{label:"GPU类型"},{default:l(()=>[e(Z,{modelValue:n.value.gpuType,"onUpdate:modelValue":t[3]||(t[3]=a=>n.value.gpuType=a),placeholder:"请选择GPU类型",style:{width:"100%"}},{default:l(()=>[e(v,{label:"NVIDIA A100",value:"NVIDIA A100"}),e(v,{label:"NVIDIA H100",value:"NVIDIA H100"}),e(v,{label:"昇腾 910B",value:"昇腾 910B"}),e(v,{label:"沐曦 C500",value:"沐曦 C500"}),e(v,{label:"海光 DCU",value:"海光 DCU"}),e(v,{label:"摩尔线程 MTT S80",value:"摩尔线程 MTT S80"}),e(v,{label:"阿里 PPU",value:"阿里 PPU"})]),_:1},8,["modelValue"])]),_:1}),e(_,{label:"GPU数量"},{default:l(()=>[e(x,{modelValue:n.value.gpuCount,"onUpdate:modelValue":t[4]||(t[4]=a=>n.value.gpuCount=a),min:1,max:8},null,8,["modelValue"])]),_:1}),e(_,{label:"单卡显存(GB)"},{default:l(()=>[e(x,{modelValue:n.value.memoryPerGPU,"onUpdate:modelValue":t[5]||(t[5]=a=>n.value.memoryPerGPU=a),min:16,max:128,step:8},null,8,["modelValue"])]),_:1}),e(_,{label:"利用率(%)"},{default:l(()=>[e(h,{modelValue:n.value.utilization,"onUpdate:modelValue":t[6]||(t[6]=a=>n.value.utilization=a),max:100},null,8,["modelValue"])]),_:1}),e(_,{label:"可用卡数"},{default:l(()=>[e(x,{modelValue:n.value.availableGPUs,"onUpdate:modelValue":t[7]||(t[7]=a=>n.value.availableGPUs=a),min:0,max:n.value.gpuCount},null,8,["modelValue","max"])]),_:1}),e(_,{label:"状态"},{default:l(()=>[e(ee,{modelValue:n.value.status,"onUpdate:modelValue":t[8]||(t[8]=a=>n.value.status=a)},{default:l(()=>[e(w,{value:"online"},{default:l(()=>t[18]||(t[18]=[u("在线",-1)])),_:1,__:[18]}),e(w,{value:"offline"},{default:l(()=>t[19]||(t[19]=[u("离线",-1)])),_:1,__:[19]})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),e(I,{modelValue:E.value,"onUpdate:modelValue":t[11]||(t[11]=a=>E.value=a),title:"GPU节点详情",width:"800px"},{default:l(()=>[r.value?(k(),se(te,{key:0,column:2,border:""},{default:l(()=>[e(f,{label:"节点名称"},{default:l(()=>[u(s(r.value.nodeName),1)]),_:1}),e(f,{label:"GPU类型"},{default:l(()=>[u(s(r.value.gpuType),1)]),_:1}),e(f,{label:"GPU数量"},{default:l(()=>[u(s(r.value.gpuCount),1)]),_:1}),e(f,{label:"单卡显存"},{default:l(()=>[u(s(r.value.memoryPerGPU)+" GB ",1)]),_:1}),e(f,{label:"总显存"},{default:l(()=>[u(s(r.value.gpuCount*r.value.memoryPerGPU)+" GB ",1)]),_:1}),e(f,{label:"利用率"},{default:l(()=>[u(s(r.value.utilization)+"% ",1)]),_:1}),e(f,{label:"可用卡数"},{default:l(()=>[u(s(r.value.availableGPUs)+" / "+s(r.value.gpuCount),1)]),_:1}),e(f,{label:"状态"},{default:l(()=>[e(N,{type:r.value.status==="online"?"success":"danger"},{default:l(()=>[u(s(r.value.status==="online"?"在线":"离线"),1)]),_:1},8,["type"])]),_:1})]),_:1})):re("",!0)]),_:1},8,["modelValue"])])}}});export{_l as default};
