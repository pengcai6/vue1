import{x as j,a7 as F,A as H,d as T,C as M,Y as R,c as E,o as m,F as G,a as t,e as o,J as v,a8 as W,a0 as Z,a9 as ee,r as U,R as te,j as le,D as b,aa as se,$ as ae,n as S,b as N,L as Y,m as x,w as l,ab as oe,E as K,g as ne,O as ie,p as V,i as r,a4 as re,ac as ue,u as pe,l as de}from"./index-BX2sZVyW.js";import{E as me}from"./card-B6phTZGW.js";import{E as ce}from"./button-Cn9gqGCu.js";import{a as ve,E as fe}from"./descriptions-item-CLkKtAVA.js";import{E as _e}from"./alert-eHTGQA0s.js";import{E as ye}from"./input-5aB7ALv6.js";import{E as be}from"./input-number-cfQWrT64.js";import{E as Se,a as Ee}from"./radio-group-DyO9WxrE.js";/* empty css              *//* empty css                       */import{E as ge,a as Ve}from"./checkbox-B8dDd1Mj.js";import{E as Ne}from"./divider-Cw9FL3-C.js";import{E as we,a as ke}from"./form-item-BCUJoI1X.js";/* empty css            */import{E as Ce,a as xe}from"./select-9k77N6f3.js";import"./scrollbar-C9NSq6wy.js";import{C as q}from"./event-BORzi4vc.js";import{u as Ie}from"./index-Dc9GAbAN.js";import"./index-PwB6y63X.js";import"./index-BDj3Pv7k.js";import"./isEqual-ohjdCfDM.js";import"./_baseClone-BOpOh07B.js";import"./index-BFcHm1-Q.js";import"./strings-JcT2fde-.js";import"./scroll-g5r06U3K.js";import"./debounce-DYp1oJWc.js";const Ae=j({space:{type:[Number,String],default:""},active:{type:Number,default:0},direction:{type:String,default:"horizontal",values:["horizontal","vertical"]},alignCenter:{type:Boolean},simple:{type:Boolean},finishStatus:{type:String,values:["wait","process","finish","error","success"],default:"finish"},processStatus:{type:String,values:["wait","process","finish","error","success"],default:"process"}}),$e={[q]:(I,k)=>[I,k].every(F)},Q="ElSteps",De=T({name:"ElSteps"}),Ue=T({...De,props:Ae,emits:$e,setup(I,{emit:k}){const n=I,c=M("steps"),{children:s,addChild:g,removeChild:i,ChildrenSorter:e}=Ie(W(),"ElStep");return R(s,()=>{s.value.forEach((u,f)=>{u.setIndex(f)})}),Z(Q,{props:n,steps:s,addStep:g,removeStep:i}),R(()=>n.active,(u,f)=>{k(q,u,f)}),(u,f)=>(m(),E("div",{class:v([o(c).b(),o(c).m(u.simple?"simple":u.direction)])},[G(u.$slots,"default"),t(o(e))],2))}});var Be=H(Ue,[["__file","steps.vue"]]);const Pe=j({title:{type:String,default:""},icon:{type:ee},description:{type:String,default:""},status:{type:String,values:["","wait","process","finish","error","success"],default:""}}),Le=T({name:"ElStep"}),Te=T({...Le,props:Pe,setup(I){const k=I,n=M("step"),c=U(-1),s=U({}),g=U(""),i=te(Q),e=W();le(()=>{R([()=>i.props.active,()=>i.props.processStatus,()=>i.props.finishStatus],([a])=>{J(a)},{immediate:!0})});const u=b(()=>k.status||g.value),f=b(()=>{const a=i.steps.value[c.value-1];return a?a.currentStatus:"wait"}),_=b(()=>i.props.alignCenter),B=b(()=>i.props.direction==="vertical"),d=b(()=>i.props.simple),A=b(()=>i.steps.value.length),$=b(()=>{var a;return((a=i.steps.value[A.value-1])==null?void 0:a.uid)===e.uid}),y=b(()=>d.value?"":i.props.space),P=b(()=>[n.b(),n.is(d.value?"simple":i.props.direction),n.is("flex",$.value&&!y.value&&!_.value),n.is("center",_.value&&!B.value&&!d.value)]),O=b(()=>{const a={flexBasis:F(y.value)?`${y.value}px`:y.value?y.value:`${100/(A.value-(_.value?0:1))}%`};return B.value||$.value&&(a.maxWidth=`${100/A.value}%`),a}),D=a=>{c.value=a},z=a=>{const w=a==="wait",C={transitionDelay:`${w?"-":""}${150*c.value}ms`},h=a===i.props.processStatus||w?0:100;C.borderWidth=h&&!d.value?"1px":0,C[i.props.direction==="vertical"?"height":"width"]=`${h}%`,s.value=C},J=a=>{a>c.value?g.value=i.props.finishStatus:a===c.value&&f.value!=="error"?g.value=i.props.processStatus:g.value="wait";const w=i.steps.value[c.value-1];w&&w.calcProgress(g.value)},L=se({uid:e.uid,getVnode:()=>e.vnode,currentStatus:u,setIndex:D,calcProgress:z});return i.addStep(L),ae(()=>{i.removeStep(L)}),(a,w)=>(m(),E("div",{style:Y(o(O)),class:v(o(P))},[S(" icon & line "),N("div",{class:v([o(n).e("head"),o(n).is(o(u))])},[o(d)?S("v-if",!0):(m(),E("div",{key:0,class:v(o(n).e("line"))},[N("i",{class:v(o(n).e("line-inner")),style:Y(s.value)},null,6)],2)),N("div",{class:v([o(n).e("icon"),o(n).is(a.icon||a.$slots.icon?"icon":"text")])},[G(a.$slots,"icon",{},()=>[a.icon?(m(),x(o(K),{key:0,class:v(o(n).e("icon-inner"))},{default:l(()=>[(m(),x(oe(a.icon)))]),_:1},8,["class"])):o(u)==="success"?(m(),x(o(K),{key:1,class:v([o(n).e("icon-inner"),o(n).is("status")])},{default:l(()=>[t(o(ne))]),_:1},8,["class"])):o(u)==="error"?(m(),x(o(K),{key:2,class:v([o(n).e("icon-inner"),o(n).is("status")])},{default:l(()=>[t(o(ie))]),_:1},8,["class"])):o(d)?S("v-if",!0):(m(),E("div",{key:3,class:v(o(n).e("icon-inner"))},V(c.value+1),3))])],2)],2),S(" title & description "),N("div",{class:v(o(n).e("main"))},[N("div",{class:v([o(n).e("title"),o(n).is(o(u))])},[G(a.$slots,"title",{},()=>[r(V(a.title),1)])],2),o(d)?(m(),E("div",{key:0,class:v(o(n).e("arrow"))},null,2)):(m(),E("div",{key:1,class:v([o(n).e("description"),o(n).is(o(u))])},[G(a.$slots,"description",{},()=>[r(V(a.description),1)])],2))],2)],6))}});var X=H(Te,[["__file","item.vue"]]);const he=re(Be,{Step:X}),Ge=ue(X),Oe={class:"one-click-deploy-page p-5"},ze={key:0},Je={key:1},Ke={key:2},Re={class:"mt-6 flex gap-3"},_t=T({__name:"one-click-deploy",setup(I){const k=pe(),n=U(0),c=U(!1),s=U({modelName:"",serviceName:"",description:"",capabilities:["chat"],cluster:"",gpuSpec:"A100-1",replicas:2,envVars:"",startupArgs:""});async function g(){c.value=!0,await new Promise(f=>setTimeout(f,2e3));const i=localStorage.getItem("deployment-services"),e=i?JSON.parse(i):[],u={id:Date.now().toString(),serviceName:s.value.serviceName,status:"running",online:!0,modelName:s.value.modelName,replicas:s.value.replicas,cluster:s.value.cluster,createTime:new Date().toLocaleString()};e.unshift(u),localStorage.setItem("deployment-services",JSON.stringify(e)),c.value=!1,de.success("模型部署成功！"),setTimeout(()=>{k.push("/model-deployment/service-list")},1e3)}return(i,e)=>{const u=Ge,f=he,_=xe,B=Ce,d=ke,A=we,$=Ne,y=ye,P=Ve,O=ge,D=Ee,z=Se,J=be,L=_e,a=fe,w=ve,C=ce,h=me;return m(),E("div",Oe,[t(h,null,{default:l(()=>[e[27]||(e[27]=N("h2",{class:"text-2xl font-bold mb-4"},"一键部署模型",-1)),t(f,{active:n.value,"finish-status":"success",class:"mb-6"},{default:l(()=>[t(u,{title:"选择模型"}),t(u,{title:"配置部署"}),t(u,{title:"确认部署"})]),_:1},8,["active"]),n.value===0?(m(),E("div",ze,[t(A,{model:s.value,"label-width":"150px"},{default:l(()=>[t(d,{label:"选择模型"},{default:l(()=>[t(B,{modelValue:s.value.modelName,"onUpdate:modelValue":e[0]||(e[0]=p=>s.value.modelName=p),placeholder:"请选择要部署的模型",style:{width:"100%"}},{default:l(()=>[t(_,{label:"Llama-2-7B",value:"llama-2-7b"}),t(_,{label:"ChatGLM-6B",value:"chatglm-6b"}),t(_,{label:"Qwen-7B",value:"qwen-7b"}),t(_,{label:"Stable-Diffusion-XL",value:"sd-xl"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])])):S("",!0),n.value===1?(m(),E("div",Je,[t(A,{model:s.value,"label-width":"150px"},{default:l(()=>[t($,{"content-position":"left"},{default:l(()=>e[11]||(e[11]=[r(" 基础配置 ",-1)])),_:1,__:[11]}),t(d,{label:"服务名称"},{default:l(()=>[t(y,{modelValue:s.value.serviceName,"onUpdate:modelValue":e[1]||(e[1]=p=>s.value.serviceName=p),placeholder:"请输入服务名称",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(d,{label:"服务描述"},{default:l(()=>[t(y,{modelValue:s.value.description,"onUpdate:modelValue":e[2]||(e[2]=p=>s.value.description=p),type:"textarea",rows:2,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(d,{label:"服务能力"},{default:l(()=>[t(O,{modelValue:s.value.capabilities,"onUpdate:modelValue":e[3]||(e[3]=p=>s.value.capabilities=p)},{default:l(()=>[t(P,{value:"chat"},{default:l(()=>e[12]||(e[12]=[r(" 对话 ",-1)])),_:1,__:[12]}),t(P,{value:"completion"},{default:l(()=>e[13]||(e[13]=[r(" 文本补全 ",-1)])),_:1,__:[13]}),t(P,{value:"embedding"},{default:l(()=>e[14]||(e[14]=[r(" 向量化 ",-1)])),_:1,__:[14]})]),_:1},8,["modelValue"])]),_:1}),t($,{"content-position":"left"},{default:l(()=>e[15]||(e[15]=[r(" 资源配置 ",-1)])),_:1,__:[15]}),t(d,{label:"选择集群"},{default:l(()=>[t(B,{modelValue:s.value.cluster,"onUpdate:modelValue":e[4]||(e[4]=p=>s.value.cluster=p),placeholder:"请选择集群",style:{width:"100%"}},{default:l(()=>[t(_,{label:"GPU集群-01",value:"gpu-cluster-01"}),t(_,{label:"GPU集群-02",value:"gpu-cluster-02"})]),_:1},8,["modelValue"])]),_:1}),t(d,{label:"算力规格"},{default:l(()=>[t(z,{modelValue:s.value.gpuSpec,"onUpdate:modelValue":e[5]||(e[5]=p=>s.value.gpuSpec=p)},{default:l(()=>[t(D,{value:"A100-1"},{default:l(()=>e[16]||(e[16]=[r("NVIDIA A100 x 1",-1)])),_:1,__:[16]}),t(D,{value:"A100-2"},{default:l(()=>e[17]||(e[17]=[r("NVIDIA A100 x 2",-1)])),_:1,__:[17]}),t(D,{value:"A100-4"},{default:l(()=>e[18]||(e[18]=[r("NVIDIA A100 x 4",-1)])),_:1,__:[18]}),t(D,{value:"H100-1"},{default:l(()=>e[19]||(e[19]=[r("NVIDIA H100 x 1",-1)])),_:1,__:[19]})]),_:1},8,["modelValue"])]),_:1}),t(d,{label:"副本数"},{default:l(()=>[t(J,{modelValue:s.value.replicas,"onUpdate:modelValue":e[6]||(e[6]=p=>s.value.replicas=p),min:1,max:10},null,8,["modelValue"]),e[20]||(e[20]=N("span",{class:"ml-2 text-sm text-gray-500"},"系统将自动调度到最优节点",-1))]),_:1,__:[20]}),t($,{"content-position":"left"},{default:l(()=>e[21]||(e[21]=[r(" 高级配置 ",-1)])),_:1,__:[21]}),t(d,{label:"环境变量"},{default:l(()=>[t(y,{modelValue:s.value.envVars,"onUpdate:modelValue":e[7]||(e[7]=p=>s.value.envVars=p),type:"textarea",rows:3,placeholder:`KEY1=VALUE1
KEY2=VALUE2`,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(d,{label:"启动参数"},{default:l(()=>[t(y,{modelValue:s.value.startupArgs,"onUpdate:modelValue":e[8]||(e[8]=p=>s.value.startupArgs=p),type:"textarea",rows:2,placeholder:"--max-batch-size=32",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])):S("",!0),n.value===2?(m(),E("div",Ke,[t(L,{type:"success",closable:!1,class:"mb-4"},{title:l(()=>e[22]||(e[22]=[N("div",{class:"font-bold"},"部署配置确认",-1)])),_:1}),t(w,{column:2,border:""},{default:l(()=>[t(a,{label:"模型名称"},{default:l(()=>[r(V(s.value.modelName),1)]),_:1}),t(a,{label:"服务名称"},{default:l(()=>[r(V(s.value.serviceName),1)]),_:1}),t(a,{label:"集群"},{default:l(()=>[r(V(s.value.cluster),1)]),_:1}),t(a,{label:"算力规格"},{default:l(()=>[r(V(s.value.gpuSpec),1)]),_:1}),t(a,{label:"副本数"},{default:l(()=>[r(V(s.value.replicas),1)]),_:1}),t(a,{label:"服务能力"},{default:l(()=>[r(V(s.value.capabilities.join(", ")),1)]),_:1})]),_:1}),t(L,{type:"info",closable:!1,class:"mt-4"},{default:l(()=>e[23]||(e[23]=[r(" 系统将根据集群、算力规格及副本数，自动将模型服务调度到最优节点上进行部署 ",-1)])),_:1,__:[23]})])):S("",!0),N("div",Re,[n.value>0?(m(),x(C,{key:0,onClick:e[9]||(e[9]=p=>n.value--)},{default:l(()=>e[24]||(e[24]=[r(" 上一步 ",-1)])),_:1,__:[24]})):S("",!0),n.value<2?(m(),x(C,{key:1,type:"primary",onClick:e[10]||(e[10]=p=>n.value++)},{default:l(()=>e[25]||(e[25]=[r(" 下一步 ",-1)])),_:1,__:[25]})):S("",!0),n.value===2?(m(),x(C,{key:2,type:"primary",loading:c.value,onClick:g},{default:l(()=>e[26]||(e[26]=[r(" 开始部署 ",-1)])),_:1,__:[26]},8,["loading"])):S("",!0)])]),_:1,__:[27]})])}}});export{_t as default};
