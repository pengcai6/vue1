import{d as C,r as c,a5 as q,c as P,a as e,m as R,n as B,w as l,o as E,b as f,i as s,p as u,l as L,ag as N,_ as S}from"./index-BX2sZVyW.js";import{E as z,a as U}from"./descriptions-item-CLkKtAVA.js";import{E as h}from"./card-B6phTZGW.js";import{E as D,a as M}from"./form-item-BCUJoI1X.js";import{E as $}from"./button-Cn9gqGCu.js";import{E as A}from"./input-5aB7ALv6.js";import{E as I}from"./input-number-cfQWrT64.js";import"./divider-Cw9FL3-C.js";import{E as H}from"./page-header-BYBfeuC8.js";import{i as O}from"./index-C3W-oE5n.js";import"./event-BORzi4vc.js";import"./_baseClone-BOpOh07B.js";import"./index-PwB6y63X.js";import"./index-BDj3Pv7k.js";const j={class:"performance-testing-page"},G={class:"mt-6"},J=C({__name:"performance-testing",setup(K){const v=c(!1),n=c({concurrency:10,requests:100,prompt:"介绍一下人工智能"}),o=c(null),T=c(null);let a=null;async function y(){v.value=!0,o.value=null,await new Promise(m=>setTimeout(m,3e3)),o.value={totalRequests:n.value.requests,successCount:n.value.requests-2,failureCount:2,avgTTFT:145,p95TTFT:230,p99TTFT:280,avgTPS:48,throughput:25.5,totalTime:3.9},v.value=!1,L.success("性能测试完成"),N(()=>{x()})}function x(){if(!T.value)return;a&&a.dispose(),a=O(T.value);const m=[],t=50;for(let i=0;i<t;i++)m.push(Math.floor(Math.random()*200)+100);m.sort((i,p)=>i-p),a.setOption({tooltip:{trigger:"axis"},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:m.map((i,p)=>`Req ${p+1}`)},yAxis:{type:"value",name:"Latency (ms)"},series:[{name:"Latency",data:m,type:"bar",itemStyle:{color:"#409eff"}}]})}const b=()=>{a==null||a.resize()};return window.addEventListener("resize",b),q(()=>{window.removeEventListener("resize",b),a==null||a.dispose()}),(m,t)=>{const i=H,p=I,_=M,V=A,F=$,w=D,g=h,r=z,k=U;return E(),P("div",j,[e(i,{onBack:t[0]||(t[0]=d=>m.$router.back())},{content:l(()=>t[4]||(t[4]=[f("span",{class:"text-2xl font-bold"},"性能测试与报告",-1)])),_:1}),e(g,{class:"mt-4"},{default:l(()=>[t[6]||(t[6]=f("h3",{class:"font-bold mb-4"},"启动性能测试",-1)),e(w,{model:n.value,"label-width":"150px"},{default:l(()=>[e(_,{label:"测试并发数"},{default:l(()=>[e(p,{modelValue:n.value.concurrency,"onUpdate:modelValue":t[1]||(t[1]=d=>n.value.concurrency=d),min:1,max:100},null,8,["modelValue"])]),_:1}),e(_,{label:"测试请求数"},{default:l(()=>[e(p,{modelValue:n.value.requests,"onUpdate:modelValue":t[2]||(t[2]=d=>n.value.requests=d),min:10,max:1e4},null,8,["modelValue"])]),_:1}),e(_,{label:"测试提示词"},{default:l(()=>[e(V,{modelValue:n.value.prompt,"onUpdate:modelValue":t[3]||(t[3]=d=>n.value.prompt=d),type:"textarea",rows:3},null,8,["modelValue"])]),_:1}),e(_,null,{default:l(()=>[e(F,{type:"primary",loading:v.value,onClick:y},{default:l(()=>t[5]||(t[5]=[s(" 开始测试 ",-1)])),_:1,__:[5]},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1,__:[6]}),o.value?(E(),R(g,{key:0,class:"mt-4"},{default:l(()=>[t[8]||(t[8]=f("h3",{class:"font-bold mb-4"},"测试报告",-1)),e(k,{column:3,border:""},{default:l(()=>[e(r,{label:"总请求数"},{default:l(()=>[s(u(o.value.totalRequests),1)]),_:1}),e(r,{label:"成功数"},{default:l(()=>[s(u(o.value.successCount),1)]),_:1}),e(r,{label:"失败数"},{default:l(()=>[s(u(o.value.failureCount),1)]),_:1}),e(r,{label:"平均TTFT"},{default:l(()=>[s(u(o.value.avgTTFT)+" ms",1)]),_:1}),e(r,{label:"P95 TTFT"},{default:l(()=>[s(u(o.value.p95TTFT)+" ms",1)]),_:1}),e(r,{label:"P99 TTFT"},{default:l(()=>[s(u(o.value.p99TTFT)+" ms",1)]),_:1}),e(r,{label:"平均TPS"},{default:l(()=>[s(u(o.value.avgTPS)+" tokens/s",1)]),_:1}),e(r,{label:"吞吐量"},{default:l(()=>[s(u(o.value.throughput)+" req/s",1)]),_:1}),e(r,{label:"总耗时"},{default:l(()=>[s(u(o.value.totalTime)+" s",1)]),_:1})]),_:1}),f("div",G,[t[7]||(t[7]=f("h4",{class:"font-bold mb-4"},"响应时间分布",-1)),f("div",{ref_key:"chartRef",ref:T,style:{width:"100%",height:"400px"}},null,512)])]),_:1,__:[8]})):B("",!0)])}}}),me=S(J,[["__scopeId","data-v-3b37b4bd"]]);export{me as default};
