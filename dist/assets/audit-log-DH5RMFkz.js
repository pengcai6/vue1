import{d as Y,r as f,y as C,h as $,b as H,o as q,f as e,w as t,e as w,a as i,t as r,E as J,C as Q,b2 as Z,c as ee,j as ae,_ as te}from"./index-C1LNxWrc.js";import{E as le}from"./dialog-D1_iS1Vq.js";import{E as oe,a as se}from"./descriptions-item-BClrjkTE.js";import{E as ne}from"./card-bOHwtd_N.js";import{E as ie}from"./pagination-C_8mWErZ.js";/* empty css            */import{E as re,a as ue}from"./select-BSsX693L.js";import"./scrollbar-CWDB5A-B.js";import{E as de}from"./input-LGwqt1-Y.js";import{E as pe,a as me}from"./table-column-QOtjyKSd.js";import"./checkbox-D429Hkk4.js";import{E as ce,a as ge}from"./form-item-BZC8dQDK.js";import{E as _e}from"./date-picker-Cnmdp5g_.js";import{E as fe}from"./button-CfgjJGa2.js";import{g as ye,s as ve}from"./storage-2nKQMLp0.js";import{E as Te}from"./index-gsKI2Iim.js";import{E as be}from"./index-JFsgmBjq.js";import"./index-DaWWsILK.js";import"./scroll-RLo4NxSV.js";import"./index-DRLRXOGd.js";import"./use-form-common-props-dMO5F-Xy.js";import"./isEqual-CFwnnDW_.js";import"./strings-BOPxCUMK.js";import"./_initCloneObject-T9RaIEd1.js";import"./index-BPEUnmM4.js";import"./debounce-C4p0xsPh.js";import"./_baseIteratee-CNffayvf.js";import"./isPlainObject-BS8VhLgB.js";import"./_baseClone-0EgoVDGI.js";import"./index-BYwYey8Q.js";const he={class:"audit-log-page"},we={class:"card-header"},Ee={class:"pagination"},x="audit_logs_data",Ae=Y({__name:"audit-log",setup(Pe){const s=f({logType:"",actionType:"",userName:"",ipAddress:"",dateRange:[]}),v=f([]),m=f(1),y=f(10),T=f(!1),n=f(null),z=()=>{const l=[{id:"log-001",logType:"login",actionType:"login",userName:"张三",userId:"user-001",module:"用户认证",description:"用户登录系统",ipAddress:"192.168.1.100",location:"北京市 朝阳区",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) Chrome/120.0.0.0",status:"success",timestamp:"2024-06-20 09:15:23",duration:156,requestPath:"/api/auth/login",requestParams:'{"username": "zhangsan", "loginType": "password"}'},{id:"log-002",logType:"operation",actionType:"create",userName:"张三",userId:"user-001",module:"模型部署",description:"创建模型部署服务: qwen-chat-api",ipAddress:"192.168.1.100",location:"北京市 朝阳区",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) Chrome/120.0.0.0",status:"success",timestamp:"2024-06-20 09:30:45",duration:2340,requestPath:"/api/deployment/create",requestParams:'{"modelId": "model-001", "instanceType": "gpu.a100.1x", "replicas": 2}'},{id:"log-003",logType:"operation",actionType:"update",userName:"李四",userId:"user-002",module:"数据集管理",description:"更新数据集: 客服对话数据集",ipAddress:"192.168.1.105",location:"上海市 浦东新区",userAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) Safari/605.1.15",status:"success",timestamp:"2024-06-20 10:12:18",duration:567,requestPath:"/api/dataset/update",requestParams:'{"datasetId": "dataset-001", "description": "更新数据集描述"}'},{id:"log-004",logType:"operation",actionType:"delete",userName:"王五",userId:"user-003",module:"模型微调",description:"删除微调任务: task-finetune-123",ipAddress:"192.168.1.110",location:"深圳市 南山区",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) Edge/120.0.0.0",status:"success",timestamp:"2024-06-20 11:25:33",duration:234,requestPath:"/api/finetune/delete",requestParams:'{"taskId": "task-finetune-123"}'},{id:"log-005",logType:"login",actionType:"login",userName:"admin",userId:"user-admin",module:"用户认证",description:"管理员登录失败 - 密码错误",ipAddress:"203.0.113.45",location:"未知地区",userAgent:"Mozilla/5.0 (X11; Linux x86_64) Firefox/120.0",status:"failed",timestamp:"2024-06-20 12:05:12",duration:89,requestPath:"/api/auth/login",requestParams:'{"username": "admin", "loginType": "password"}'},{id:"log-006",logType:"operation",actionType:"create",userName:"赵六",userId:"user-004",module:"模型测评",description:"创建模型测评任务",ipAddress:"192.168.1.115",location:"杭州市 西湖区",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) Chrome/120.0.0.0",status:"success",timestamp:"2024-06-20 13:40:56",duration:1234,requestPath:"/api/evaluation/create",requestParams:'{"modelId": "model-002", "benchmarks": ["MMLU", "C-Eval"]}'},{id:"log-007",logType:"system",actionType:"update",userName:"system",userId:"system",module:"系统配置",description:"自动扩缩容规则触发 - GPU利用率超过80%",ipAddress:"127.0.0.1",location:"本地",userAgent:"System Internal",status:"success",timestamp:"2024-06-20 14:15:30",duration:3456,requestPath:"/internal/autoscaling/trigger",requestParams:'{"serviceId": "service-001", "metric": "gpu_utilization", "value": 0.85}'},{id:"log-008",logType:"operation",actionType:"query",userName:"钱七",userId:"user-005",module:"模型广场",description:"查询模型列表",ipAddress:"192.168.1.120",location:"广州市 天河区",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 17_0 like Mac OS X) Safari/604.1",status:"success",timestamp:"2024-06-20 15:22:45",duration:123,requestPath:"/api/models/list",requestParams:'{"category": "chat", "pageSize": 20}'}];v.value=l,ve(x,l)},k=()=>{const l=ye(x);l&&Array.isArray(l)&&l.length>0?v.value=l:z()},E=C(()=>{let l=v.value;if(s.value.logType&&(l=l.filter(a=>a.logType===s.value.logType)),s.value.actionType&&(l=l.filter(a=>a.actionType===s.value.actionType)),s.value.userName&&(l=l.filter(a=>a.userName.toLowerCase().includes(s.value.userName.toLowerCase()))),s.value.ipAddress&&(l=l.filter(a=>a.ipAddress.includes(s.value.ipAddress))),s.value.dateRange&&s.value.dateRange.length===2){const[a,b]=s.value.dateRange;l=l.filter(c=>{const d=new Date(c.timestamp).getTime();return d>=a.getTime()&&d<=b.getTime()})}return l}),S=C(()=>{const l=(m.value-1)*y.value,a=l+y.value;return E.value.slice(l,a)}),M=()=>{m.value=1},L=()=>{s.value={logType:"",actionType:"",userName:"",ipAddress:"",dateRange:[]},m.value=1},D=l=>{n.value=l,T.value=!0},U=()=>{be.success("日志导出功能（演示模式）- 已生成 CSV 文件")},A=l=>({login:"登录",operation:"操作",system:"系统"})[l]||l,P=l=>({login:"primary",operation:"success",system:"warning"})[l]||"",V=l=>({create:"创建",update:"更新",delete:"删除",query:"查询",login:"登录",logout:"登出"})[l]||l,N=l=>({create:"success",update:"warning",delete:"danger",query:"info",login:"primary",logout:"info"})[l]||"",R=l=>{y.value=l,m.value=1},W=l=>{m.value=l};return $(()=>{k()}),(l,a)=>{const b=J,c=fe,d=ue,I=re,g=ge,h=de,B=_e,O=ce,p=me,_=Te,F=pe,X=ie,j=ne,u=se,G=oe,K=le;return q(),H("div",he,[e(j,null,{header:t(()=>[w("div",we,[a[10]||(a[10]=w("span",{class:"title"},"审计日志",-1)),e(c,{type:"primary",onClick:U},{default:t(()=>[e(b,null,{default:t(()=>[e(Q(Z))]),_:1}),a[9]||(a[9]=i(" 导出日志 ",-1))]),_:1,__:[9]})])]),default:t(()=>[e(O,{inline:!0,class:"search-form"},{default:t(()=>[e(g,{label:"日志类型"},{default:t(()=>[e(I,{modelValue:s.value.logType,"onUpdate:modelValue":a[0]||(a[0]=o=>s.value.logType=o),placeholder:"请选择日志类型",clearable:"",style:{width:"150px"}},{default:t(()=>[e(d,{label:"全部",value:""}),e(d,{label:"登录日志",value:"login"}),e(d,{label:"操作日志",value:"operation"}),e(d,{label:"系统日志",value:"system"})]),_:1},8,["modelValue"])]),_:1}),e(g,{label:"操作类型"},{default:t(()=>[e(I,{modelValue:s.value.actionType,"onUpdate:modelValue":a[1]||(a[1]=o=>s.value.actionType=o),placeholder:"请选择操作类型",clearable:"",style:{width:"150px"}},{default:t(()=>[e(d,{label:"全部",value:""}),e(d,{label:"创建",value:"create"}),e(d,{label:"更新",value:"update"}),e(d,{label:"删除",value:"delete"}),e(d,{label:"查询",value:"query"})]),_:1},8,["modelValue"])]),_:1}),e(g,{label:"用户"},{default:t(()=>[e(h,{modelValue:s.value.userName,"onUpdate:modelValue":a[2]||(a[2]=o=>s.value.userName=o),placeholder:"请输入用户名",clearable:"",style:{width:"150px"}},null,8,["modelValue"])]),_:1}),e(g,{label:"IP地址"},{default:t(()=>[e(h,{modelValue:s.value.ipAddress,"onUpdate:modelValue":a[3]||(a[3]=o=>s.value.ipAddress=o),placeholder:"请输入IP地址",clearable:"",style:{width:"150px"}},null,8,["modelValue"])]),_:1}),e(g,{label:"时间范围"},{default:t(()=>[e(B,{modelValue:s.value.dateRange,"onUpdate:modelValue":a[4]||(a[4]=o=>s.value.dateRange=o),type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间",style:{width:"380px"}},null,8,["modelValue"])]),_:1}),e(g,null,{default:t(()=>[e(c,{type:"primary",onClick:M},{default:t(()=>a[11]||(a[11]=[i("查询",-1)])),_:1,__:[11]}),e(c,{onClick:L},{default:t(()=>a[12]||(a[12]=[i("重置",-1)])),_:1,__:[12]})]),_:1})]),_:1}),e(F,{data:S.value,border:"",style:{width:"100%"}},{default:t(()=>[e(p,{prop:"id",label:"日志ID",width:"140"}),e(p,{prop:"logType",label:"日志类型",width:"100",align:"center"},{default:t(({row:o})=>[e(_,{type:P(o.logType)},{default:t(()=>[i(r(A(o.logType)),1)]),_:2},1032,["type"])]),_:1}),e(p,{prop:"actionType",label:"操作类型",width:"100",align:"center"},{default:t(({row:o})=>[e(_,{type:N(o.actionType)},{default:t(()=>[i(r(V(o.actionType)),1)]),_:2},1032,["type"])]),_:1}),e(p,{prop:"userName",label:"用户",width:"120"}),e(p,{prop:"module",label:"模块",width:"120"}),e(p,{prop:"description",label:"操作描述","min-width":"250","show-overflow-tooltip":""}),e(p,{prop:"ipAddress",label:"IP地址",width:"140"}),e(p,{prop:"userAgent",label:"浏览器",width:"150","show-overflow-tooltip":""}),e(p,{prop:"status",label:"状态",width:"80",align:"center"},{default:t(({row:o})=>[e(_,{type:o.status==="success"?"success":"danger"},{default:t(()=>[i(r(o.status==="success"?"成功":"失败"),1)]),_:2},1032,["type"])]),_:1}),e(p,{prop:"timestamp",label:"时间",width:"180"}),e(p,{label:"操作",width:"100",fixed:"right"},{default:t(({row:o})=>[e(c,{link:"",type:"primary",size:"small",onClick:Ve=>D(o)},{default:t(()=>a[13]||(a[13]=[i("详情",-1)])),_:2,__:[13]},1032,["onClick"])]),_:1})]),_:1},8,["data"]),w("div",Ee,[e(X,{"current-page":m.value,"onUpdate:currentPage":a[5]||(a[5]=o=>m.value=o),"page-size":y.value,"onUpdate:pageSize":a[6]||(a[6]=o=>y.value=o),"page-sizes":[10,20,50,100],total:E.value.length,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:R,onCurrentChange:W},null,8,["current-page","page-size","total"])])]),_:1}),e(K,{modelValue:T.value,"onUpdate:modelValue":a[8]||(a[8]=o=>T.value=o),title:"日志详情",width:"700px"},{default:t(()=>[n.value?(q(),ee(G,{key:0,column:2,border:""},{default:t(()=>[e(u,{label:"日志ID"},{default:t(()=>[i(r(n.value.id),1)]),_:1}),e(u,{label:"日志类型"},{default:t(()=>[e(_,{type:P(n.value.logType)},{default:t(()=>[i(r(A(n.value.logType)),1)]),_:1},8,["type"])]),_:1}),e(u,{label:"操作类型"},{default:t(()=>[e(_,{type:N(n.value.actionType)},{default:t(()=>[i(r(V(n.value.actionType)),1)]),_:1},8,["type"])]),_:1}),e(u,{label:"用户"},{default:t(()=>[i(r(n.value.userName),1)]),_:1}),e(u,{label:"模块"},{default:t(()=>[i(r(n.value.module),1)]),_:1}),e(u,{label:"状态"},{default:t(()=>[e(_,{type:n.value.status==="success"?"success":"danger"},{default:t(()=>[i(r(n.value.status==="success"?"成功":"失败"),1)]),_:1},8,["type"])]),_:1}),e(u,{label:"操作描述",span:2},{default:t(()=>[i(r(n.value.description),1)]),_:1}),e(u,{label:"IP地址"},{default:t(()=>[i(r(n.value.ipAddress),1)]),_:1}),e(u,{label:"地理位置"},{default:t(()=>[i(r(n.value.location),1)]),_:1}),e(u,{label:"浏览器",span:2},{default:t(()=>[i(r(n.value.userAgent),1)]),_:1}),e(u,{label:"时间戳"},{default:t(()=>[i(r(n.value.timestamp),1)]),_:1}),e(u,{label:"请求耗时"},{default:t(()=>[i(r(n.value.duration)+"ms",1)]),_:1}),e(u,{label:"请求路径",span:2},{default:t(()=>[i(r(n.value.requestPath),1)]),_:1}),e(u,{label:"请求参数",span:2},{default:t(()=>[e(h,{modelValue:n.value.requestParams,"onUpdate:modelValue":a[7]||(a[7]=o=>n.value.requestParams=o),type:"textarea",rows:3,readonly:"",style:{"font-family":"monospace","font-size":"12px"}},null,8,["modelValue"])]),_:1})]),_:1})):ae("",!0)]),_:1},8,["modelValue"])])}}}),la=te(Ae,[["__scopeId","data-v-94fe6cbe"]]);export{la as default};
