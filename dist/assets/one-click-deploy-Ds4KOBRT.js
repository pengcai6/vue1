import{v as j,a4 as M,_ as R,d as T,A as F,W,c as E,o as m,C as z,a as t,e as o,H as v,a5 as h,Z,a6 as ee,r as B,P as te,j as le,B as b,a7 as se,Y as ae,m as y,b as N,J as Y,l as x,w as l,a8 as oe,E as K,g as ne,L as re,n as V,i,a2 as ie,a9 as ue,u as pe}from"./index-DAZDpghP.js";import{E as de}from"./card-_e8Y2itV.js";import{E as me}from"./button-CFFx6FdR.js";import{a as ce,E as ve}from"./descriptions-item-DIjWwK7N.js";import{E as fe}from"./alert-C4LvZx9F.js";import{E as _e}from"./input-BsUoEHjr.js";import{E as Se}from"./input-number-BUSsIkB9.js";import{E as be,a as ye}from"./radio-ChFPTsFt.js";/* empty css                       */import{E as Ee,a as ge}from"./checkbox-DDntw5na.js";import{E as Ve}from"./divider-BbpLxVZK.js";import{E as Ne,a as ke}from"./form-item-D50nbGgb.js";/* empty css            */import{E as we,a as Ce}from"./select-B_Nc0zOl.js";import"./scrollbar-BKn1N4ug.js";import{C as q}from"./event-D5_Wo8Xc.js";import{u as xe}from"./index-BtSJ9mPq.js";import{E as Ie}from"./index-B4p_U5VT.js";import"./index-17xiCnpu.js";import"./index-BBjiecLk.js";import"./isEqual-DlB8YXyV.js";import"./_baseClone-BBryStzM.js";import"./index-i9SNigSW.js";import"./strings-BN0-5NCg.js";import"./scroll-PXqKi88e.js";import"./debounce-Bv_84CHO.js";import"./_baseIteratee-DgY2c_zD.js";const Ae=j({space:{type:[Number,String],default:""},active:{type:Number,default:0},direction:{type:String,default:"horizontal",values:["horizontal","vertical"]},alignCenter:{type:Boolean},simple:{type:Boolean},finishStatus:{type:String,values:["wait","process","finish","error","success"],default:"finish"},processStatus:{type:String,values:["wait","process","finish","error","success"],default:"process"}}),$e={[q]:(I,w)=>[I,w].every(M)},Q="ElSteps",Ue=T({name:"ElSteps"}),Be=T({...Ue,props:Ae,emits:$e,setup(I,{emit:w}){const n=I,c=F("steps"),{children:s,addChild:g,removeChild:r,ChildrenSorter:e}=xe(h(),"ElStep");return W(s,()=>{s.value.forEach((u,f)=>{u.setIndex(f)})}),Z(Q,{props:n,steps:s,addStep:g,removeStep:r}),W(()=>n.active,(u,f)=>{w(q,u,f)}),(u,f)=>(m(),E("div",{class:v([o(c).b(),o(c).m(u.simple?"simple":u.direction)])},[z(u.$slots,"default"),t(o(e))],2))}});var De=R(Be,[["__file","steps.vue"]]);const Pe=j({title:{type:String,default:""},icon:{type:ee},description:{type:String,default:""},status:{type:String,values:["","wait","process","finish","error","success"],default:""}}),Le=T({name:"ElStep"}),Te=T({...Le,props:Pe,setup(I){const w=I,n=F("step"),c=B(-1),s=B({}),g=B(""),r=te(Q),e=h();le(()=>{W([()=>r.props.active,()=>r.props.processStatus,()=>r.props.finishStatus],([a])=>{J(a)},{immediate:!0})});const u=b(()=>w.status||g.value),f=b(()=>{const a=r.steps.value[c.value-1];return a?a.currentStatus:"wait"}),_=b(()=>r.props.alignCenter),D=b(()=>r.props.direction==="vertical"),d=b(()=>r.props.simple),A=b(()=>r.steps.value.length),$=b(()=>{var a;return((a=r.steps.value[A.value-1])==null?void 0:a.uid)===e.uid}),S=b(()=>d.value?"":r.props.space),P=b(()=>[n.b(),n.is(d.value?"simple":r.props.direction),n.is("flex",$.value&&!S.value&&!_.value),n.is("center",_.value&&!D.value&&!d.value)]),O=b(()=>{const a={flexBasis:M(S.value)?`${S.value}px`:S.value?S.value:`${100/(A.value-(_.value?0:1))}%`};return D.value||$.value&&(a.maxWidth=`${100/A.value}%`),a}),U=a=>{c.value=a},H=a=>{const k=a==="wait",C={transitionDelay:`${k?"-":""}${150*c.value}ms`},G=a===r.props.processStatus||k?0:100;C.borderWidth=G&&!d.value?"1px":0,C[r.props.direction==="vertical"?"height":"width"]=`${G}%`,s.value=C},J=a=>{a>c.value?g.value=r.props.finishStatus:a===c.value&&f.value!=="error"?g.value=r.props.processStatus:g.value="wait";const k=r.steps.value[c.value-1];k&&k.calcProgress(g.value)},L=se({uid:e.uid,getVnode:()=>e.vnode,currentStatus:u,setIndex:U,calcProgress:H});return r.addStep(L),ae(()=>{r.removeStep(L)}),(a,k)=>(m(),E("div",{style:Y(o(O)),class:v(o(P))},[y(" icon & line "),N("div",{class:v([o(n).e("head"),o(n).is(o(u))])},[o(d)?y("v-if",!0):(m(),E("div",{key:0,class:v(o(n).e("line"))},[N("i",{class:v(o(n).e("line-inner")),style:Y(s.value)},null,6)],2)),N("div",{class:v([o(n).e("icon"),o(n).is(a.icon||a.$slots.icon?"icon":"text")])},[z(a.$slots,"icon",{},()=>[a.icon?(m(),x(o(K),{key:0,class:v(o(n).e("icon-inner"))},{default:l(()=>[(m(),x(oe(a.icon)))]),_:1},8,["class"])):o(u)==="success"?(m(),x(o(K),{key:1,class:v([o(n).e("icon-inner"),o(n).is("status")])},{default:l(()=>[t(o(ne))]),_:1},8,["class"])):o(u)==="error"?(m(),x(o(K),{key:2,class:v([o(n).e("icon-inner"),o(n).is("status")])},{default:l(()=>[t(o(re))]),_:1},8,["class"])):o(d)?y("v-if",!0):(m(),E("div",{key:3,class:v(o(n).e("icon-inner"))},V(c.value+1),3))])],2)],2),y(" title & description "),N("div",{class:v(o(n).e("main"))},[N("div",{class:v([o(n).e("title"),o(n).is(o(u))])},[z(a.$slots,"title",{},()=>[i(V(a.title),1)])],2),o(d)?(m(),E("div",{key:0,class:v(o(n).e("arrow"))},null,2)):(m(),E("div",{key:1,class:v([o(n).e("description"),o(n).is(o(u))])},[z(a.$slots,"description",{},()=>[i(V(a.description),1)])],2))],2)],6))}});var X=R(Te,[["__file","item.vue"]]);const Ge=ie(De,{Step:X}),ze=ue(X),Oe={class:"one-click-deploy-page p-5"},He={key:0},Je={key:1},Ke={key:2},We={class:"mt-6 flex gap-3"},St=T({__name:"one-click-deploy",setup(I){const w=pe(),n=B(0),c=B(!1),s=B({modelName:"",serviceName:"",description:"",capabilities:["chat"],cluster:"",gpuSpec:"A100-1",replicas:2,envVars:"",startupArgs:""});async function g(){c.value=!0,await new Promise(f=>setTimeout(f,2e3));const r=localStorage.getItem("deployment-services"),e=r?JSON.parse(r):[],u={id:Date.now().toString(),serviceName:s.value.serviceName,status:"running",online:!0,modelName:s.value.modelName,replicas:s.value.replicas,cluster:s.value.cluster,createTime:new Date().toLocaleString()};e.unshift(u),localStorage.setItem("deployment-services",JSON.stringify(e)),c.value=!1,Ie.success("模型部署成功！"),setTimeout(()=>{w.push("/model-deployment/service-list")},1e3)}return(r,e)=>{const u=ze,f=Ge,_=Ce,D=we,d=ke,A=Ne,$=Ve,S=_e,P=ge,O=Ee,U=ye,H=be,J=Se,L=fe,a=ve,k=ce,C=me,G=de;return m(),E("div",Oe,[t(G,null,{default:l(()=>[e[27]||(e[27]=N("h2",{class:"text-2xl font-bold mb-4"},"一键部署模型",-1)),t(f,{active:n.value,"finish-status":"success",class:"mb-6"},{default:l(()=>[t(u,{title:"选择模型"}),t(u,{title:"配置部署"}),t(u,{title:"确认部署"})]),_:1},8,["active"]),n.value===0?(m(),E("div",He,[t(A,{model:s.value,"label-width":"150px"},{default:l(()=>[t(d,{label:"选择模型"},{default:l(()=>[t(D,{modelValue:s.value.modelName,"onUpdate:modelValue":e[0]||(e[0]=p=>s.value.modelName=p),placeholder:"请选择要部署的模型",style:{width:"100%"}},{default:l(()=>[t(_,{label:"Llama-2-7B",value:"llama-2-7b"}),t(_,{label:"ChatGLM-6B",value:"chatglm-6b"}),t(_,{label:"Qwen-7B",value:"qwen-7b"}),t(_,{label:"Stable-Diffusion-XL",value:"sd-xl"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])])):y("",!0),n.value===1?(m(),E("div",Je,[t(A,{model:s.value,"label-width":"150px"},{default:l(()=>[t($,{"content-position":"left"},{default:l(()=>e[11]||(e[11]=[i(" 基础配置 ",-1)])),_:1,__:[11]}),t(d,{label:"服务名称"},{default:l(()=>[t(S,{modelValue:s.value.serviceName,"onUpdate:modelValue":e[1]||(e[1]=p=>s.value.serviceName=p),placeholder:"请输入服务名称"},null,8,["modelValue"])]),_:1}),t(d,{label:"服务描述"},{default:l(()=>[t(S,{modelValue:s.value.description,"onUpdate:modelValue":e[2]||(e[2]=p=>s.value.description=p),type:"textarea",rows:2},null,8,["modelValue"])]),_:1}),t(d,{label:"服务能力"},{default:l(()=>[t(O,{modelValue:s.value.capabilities,"onUpdate:modelValue":e[3]||(e[3]=p=>s.value.capabilities=p)},{default:l(()=>[t(P,{value:"chat"},{default:l(()=>e[12]||(e[12]=[i(" 对话 ",-1)])),_:1,__:[12]}),t(P,{value:"completion"},{default:l(()=>e[13]||(e[13]=[i(" 文本补全 ",-1)])),_:1,__:[13]}),t(P,{value:"embedding"},{default:l(()=>e[14]||(e[14]=[i(" 向量化 ",-1)])),_:1,__:[14]})]),_:1},8,["modelValue"])]),_:1}),t($,{"content-position":"left"},{default:l(()=>e[15]||(e[15]=[i(" 资源配置 ",-1)])),_:1,__:[15]}),t(d,{label:"选择集群"},{default:l(()=>[t(D,{modelValue:s.value.cluster,"onUpdate:modelValue":e[4]||(e[4]=p=>s.value.cluster=p),placeholder:"请选择集群"},{default:l(()=>[t(_,{label:"GPU集群-01",value:"gpu-cluster-01"}),t(_,{label:"GPU集群-02",value:"gpu-cluster-02"})]),_:1},8,["modelValue"])]),_:1}),t(d,{label:"算力规格"},{default:l(()=>[t(H,{modelValue:s.value.gpuSpec,"onUpdate:modelValue":e[5]||(e[5]=p=>s.value.gpuSpec=p)},{default:l(()=>[t(U,{value:"A100-1"},{default:l(()=>e[16]||(e[16]=[i("NVIDIA A100 x 1",-1)])),_:1,__:[16]}),t(U,{value:"A100-2"},{default:l(()=>e[17]||(e[17]=[i("NVIDIA A100 x 2",-1)])),_:1,__:[17]}),t(U,{value:"A100-4"},{default:l(()=>e[18]||(e[18]=[i("NVIDIA A100 x 4",-1)])),_:1,__:[18]}),t(U,{value:"H100-1"},{default:l(()=>e[19]||(e[19]=[i("NVIDIA H100 x 1",-1)])),_:1,__:[19]})]),_:1},8,["modelValue"])]),_:1}),t(d,{label:"副本数"},{default:l(()=>[t(J,{modelValue:s.value.replicas,"onUpdate:modelValue":e[6]||(e[6]=p=>s.value.replicas=p),min:1,max:10},null,8,["modelValue"]),e[20]||(e[20]=N("span",{class:"ml-2 text-sm text-gray-500"},"系统将自动调度到最优节点",-1))]),_:1,__:[20]}),t($,{"content-position":"left"},{default:l(()=>e[21]||(e[21]=[i(" 高级配置 ",-1)])),_:1,__:[21]}),t(d,{label:"环境变量"},{default:l(()=>[t(S,{modelValue:s.value.envVars,"onUpdate:modelValue":e[7]||(e[7]=p=>s.value.envVars=p),type:"textarea",rows:3,placeholder:`KEY1=VALUE1
KEY2=VALUE2`},null,8,["modelValue"])]),_:1}),t(d,{label:"启动参数"},{default:l(()=>[t(S,{modelValue:s.value.startupArgs,"onUpdate:modelValue":e[8]||(e[8]=p=>s.value.startupArgs=p),type:"textarea",rows:2,placeholder:"--max-batch-size=32"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])):y("",!0),n.value===2?(m(),E("div",Ke,[t(L,{type:"success",closable:!1,class:"mb-4"},{title:l(()=>e[22]||(e[22]=[N("div",{class:"font-bold"},"部署配置确认",-1)])),_:1}),t(k,{column:2,border:""},{default:l(()=>[t(a,{label:"模型名称"},{default:l(()=>[i(V(s.value.modelName),1)]),_:1}),t(a,{label:"服务名称"},{default:l(()=>[i(V(s.value.serviceName),1)]),_:1}),t(a,{label:"集群"},{default:l(()=>[i(V(s.value.cluster),1)]),_:1}),t(a,{label:"算力规格"},{default:l(()=>[i(V(s.value.gpuSpec),1)]),_:1}),t(a,{label:"副本数"},{default:l(()=>[i(V(s.value.replicas),1)]),_:1}),t(a,{label:"服务能力"},{default:l(()=>[i(V(s.value.capabilities.join(", ")),1)]),_:1})]),_:1}),t(L,{type:"info",closable:!1,class:"mt-4"},{default:l(()=>e[23]||(e[23]=[i(" 系统将根据集群、算力规格及副本数，自动将模型服务调度到最优节点上进行部署 ",-1)])),_:1,__:[23]})])):y("",!0),N("div",We,[n.value>0?(m(),x(C,{key:0,onClick:e[9]||(e[9]=p=>n.value--)},{default:l(()=>e[24]||(e[24]=[i(" 上一步 ",-1)])),_:1,__:[24]})):y("",!0),n.value<2?(m(),x(C,{key:1,type:"primary",onClick:e[10]||(e[10]=p=>n.value++)},{default:l(()=>e[25]||(e[25]=[i(" 下一步 ",-1)])),_:1,__:[25]})):y("",!0),n.value===2?(m(),x(C,{key:2,type:"primary",loading:c.value,onClick:g},{default:l(()=>e[26]||(e[26]=[i(" 开始部署 ",-1)])),_:1,__:[26]},8,["loading"])):y("",!0)])]),_:1,__:[27]})])}}});export{St as default};
