import{d as se,r as i,j as oe,c as I,a as e,w as t,ag as ne,o as N,G as re,H as ie,i as m,E as ue,e as de,b8 as pe,b as a,p as o,L as v,l as B,m as ce,_ as me}from"./index-BX2sZVyW.js";import{a as fe,E as ge}from"./table-column-DG__lvqo.js";import"./checkbox-B8dDd1Mj.js";import"./scrollbar-C9NSq6wy.js";/* empty css            */import{E as ve}from"./progress-B1_RPwJG.js";import{E as _e,a as ye}from"./tab-pane-BLMCB6bP.js";import{E as he,a as be}from"./col-DfCBUvxB.js";import{E as xe}from"./statistic-BIQ42bG3.js";import{E as we}from"./card-B6phTZGW.js";import{E as Pe,a as Ee}from"./form-item-BCUJoI1X.js";import{E as Te}from"./button-Cn9gqGCu.js";import{E as Se,a as Ce}from"./select-9k77N6f3.js";import{i as k}from"./index-C3W-oE5n.js";import{E as Le}from"./index-BFcHm1-Q.js";import"./event-BORzi4vc.js";import"./isPlainObject-jZyBOBeK.js";import"./debounce-DYp1oJWc.js";import"./index-PwB6y63X.js";import"./isEqual-ohjdCfDM.js";import"./strings-JcT2fde-.js";import"./index-Dc9GAbAN.js";import"./_baseClone-BOpOh07B.js";import"./scroll-g5r06U3K.js";const qe={class:"service-monitoring-page"},ke={class:"status-detail"},Re={class:"metric-detail"},Ue={class:"metric-detail"},Ae={class:"metric-detail"},Ve={class:"resource-item"},ze={class:"resource-item"},Me={class:"resource-item"},Oe={style:{display:"flex","align-items":"center","justify-content":"center"}},Ne={style:{"margin-left":"8px","white-space":"nowrap"}},Be={style:{display:"flex","align-items":"center","justify-content":"center"}},Ge={style:{"margin-left":"8px","white-space":"nowrap"}},je=se({__name:"service-monitoring",setup(Fe){const D=i([{id:"service-001",name:"qwen-chat-api"},{id:"service-002",name:"deepseek-inference"},{id:"service-003",name:"glm-service"}]),G=i("service-001"),j=i("1h"),_=i({status:"running",replicas:3,desiredReplicas:3,uptime:"15天 8小时"}),r=i({qps:245,qpsTrend:12.5,avgLatency:1234,p99Latency:2567,p95Latency:1850,successRate:99.2,errorCount:23}),E=i("ttft"),H={ttft:{unit:"ms",data:{Avg:[150,160,175,190,205,195,180],P50:[140,150,162,175,188,180,170],P90:[200,215,235,255,270,260,245],P95:[230,245,265,285,305,295,280],P99:[320,340,360,380,400,390,370]}},otps:{unit:"tokens/s",data:{Avg:[45,48,52,55,58,56,50],P50:[48,50,54,58,60,58,52],P90:[35,38,42,45,48,46,40],P95:[30,34,38,42,45,43,38],P99:[20,22,26,30,32,30,26]}},tpot:{unit:"ms/token",data:{Avg:[25,26,27,29,31,30,28],P50:[22,23,24,26,28,27,25],P90:[30,32,34,36,38,37,35],P95:[35,37,39,42,44,43,41],P99:[45,47,49,52,54,53,50]}},latency:{unit:"ms",data:{Avg:[1200,1250,1320,1400,1480,1420,1350],P50:[892,945,1023,1156,1234,1178,1089],P90:[1456,1523,1678,1823,1945,1867,1734],P95:[1680,1760,1890,2040,2190,2080,1950],P99:[2134,2267,2456,2678,2834,2723,2567]}}},f=i({gpu:78,memory:65,cpu:42}),J=i([{podName:"qwen-chat-api-deployment-7d9f8b6c5-abc12",status:"Running",qps:82,avgLatency:1189,gpuUtil:75,memoryUtil:62,requests:145678,errors:8,uptime:"15天 8小时"},{podName:"qwen-chat-api-deployment-7d9f8b6c5-def34",status:"Running",qps:85,avgLatency:1256,gpuUtil:79,memoryUtil:67,requests:152341,errors:9,uptime:"15天 8小时"},{podName:"qwen-chat-api-deployment-7d9f8b6c5-ghi56",status:"Running",qps:78,avgLatency:1267,gpuUtil:80,memoryUtil:66,requests:138954,errors:6,uptime:"15天 8小时"}]),R=i(),U=i(),A=i(),V=i();let y=null,g=null,h=null,b=null;const K=()=>{B.success("已切换服务"),T()},W=()=>{B.success("已更新时间范围"),T()},X=()=>{B.success("数据已刷新"),T()},Y=()=>{F(E.value)},T=async()=>{await ne(),R.value&&(y=k(R.value),y.setOption({tooltip:{trigger:"axis"},grid:{left:"3%",right:"4%",bottom:"3%",top:"10%",containLabel:!0},xAxis:{type:"category",data:["00:00","04:00","08:00","12:00","16:00","20:00","23:59"]},yAxis:{type:"value",name:"req/s"},series:[{name:"QPS",type:"line",smooth:!0,data:[156,189,234,278,312,289,245],itemStyle:{color:"#409eff"},areaStyle:{color:"rgba(64, 158, 255, 0.2)"}}]})),F(E.value),A.value&&(h=k(A.value),h.setOption({tooltip:{trigger:"axis"},grid:{left:"50px",right:"50px",bottom:"3%",top:"10%",containLabel:!0},xAxis:{type:"category",data:["00:00","04:00","08:00","12:00","16:00","20:00","23:59"]},yAxis:{type:"value",name:"%",max:100},series:[{name:"GPU利用率",type:"line",smooth:!0,data:[68,72,75,82,85,81,78],itemStyle:{color:"#e6a23c"},areaStyle:{color:"rgba(230, 162, 60, 0.2)"},markLine:{data:[{type:"average",name:"平均值"}],lineStyle:{color:"#f56c6c",type:"dashed"},label:{show:!0,position:"insideEndTop",formatter:"平均值: {c}%"}}}]})),V.value&&(b=k(V.value),b.setOption({tooltip:{trigger:"axis"},legend:{data:["输入TPS","输出TPS"],top:"0%"},grid:{left:"3%",right:"4%",bottom:"3%",top:"12%",containLabel:!0},xAxis:{type:"category",data:["00:00","04:00","08:00","12:00","16:00","20:00","23:59"]},yAxis:{type:"value",name:"tokens/s"},series:[{name:"输入TPS",type:"bar",data:[3456,3678,4123,4567,4890,4623,4234],itemStyle:{color:"#67c23a"}},{name:"输出TPS",type:"bar",data:[8923,9456,10345,11234,12056,11678,10789],itemStyle:{color:"#409eff"}}]}))},F=n=>{if(!U.value)return;g||(g=k(U.value));const l=H[n],c=Object.keys(l.data),x=["#409eff","#67c23a","#e6a23c","#f6c343","#f56c6c"],w=c.map((S,O)=>({name:S,type:"line",smooth:!0,data:l.data[S],itemStyle:{color:x[O%x.length]}}));g.setOption({tooltip:{trigger:"axis"},legend:{data:c,top:"0%"},grid:{left:"3%",right:"4%",bottom:"3%",top:"12%",containLabel:!0},xAxis:{type:"category",data:["00:00","04:00","08:00","12:00","16:00","20:00","23:59"]},yAxis:{type:"value",name:l.unit},series:w})},Z=n=>n>0?"#67c23a":"#f56c6c",z=n=>n<1e3?"#67c23a":n<2e3?"#e6a23c":"#f56c6c",$=n=>n>=99?"#67c23a":n>=95?"#e6a23c":"#f56c6c",M=n=>n<70?"#67c23a":n<85?"#e6a23c":"#f56c6c",ee=()=>{y==null||y.resize(),g==null||g.resize(),h==null||h.resize(),b==null||b.resize()};return oe(()=>{T(),window.addEventListener("resize",ee)}),(n,l)=>{const c=Ce,x=Se,w=Ee,S=ue,O=Te,te=Pe,u=we,Q=Le,C=xe,d=be,L=he,q=ye,ae=_e,P=ve,p=ge,le=fe;return N(),I("div",qe,[e(u,{style:{"margin-bottom":"20px"}},{default:t(()=>[e(te,{inline:!0},{default:t(()=>[e(w,{label:"选择服务"},{default:t(()=>[e(x,{modelValue:G.value,"onUpdate:modelValue":l[0]||(l[0]=s=>G.value=s),placeholder:"请选择服务",onChange:K,style:{width:"200px"}},{default:t(()=>[(N(!0),I(re,null,ie(D.value,s=>(N(),ce(c,{key:s.id,label:s.name,value:s.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(w,{label:"时间范围"},{default:t(()=>[e(x,{modelValue:j.value,"onUpdate:modelValue":l[1]||(l[1]=s=>j.value=s),onChange:W,style:{width:"150px"}},{default:t(()=>[e(c,{label:"最近1小时",value:"1h"}),e(c,{label:"最近6小时",value:"6h"}),e(c,{label:"最近24小时",value:"24h"}),e(c,{label:"最近7天",value:"7d"})]),_:1},8,["modelValue"])]),_:1}),e(w,null,{default:t(()=>[e(O,{type:"primary",onClick:X},{default:t(()=>[e(S,null,{default:t(()=>[e(de(pe))]),_:1}),l[3]||(l[3]=m(" 刷新 ",-1))]),_:1,__:[3]})]),_:1})]),_:1})]),_:1}),e(L,{gutter:20,style:{"margin-bottom":"20px"}},{default:t(()=>[e(d,{span:6},{default:t(()=>[e(u,{shadow:"hover"},{default:t(()=>[e(C,{title:"服务状态"},{default:t(()=>[e(Q,{type:_.value.status==="running"?"success":"danger",size:"large"},{default:t(()=>[m(o(_.value.status==="running"?"运行中":"异常"),1)]),_:1},8,["type"])]),_:1}),a("div",ke,[a("div",null," 副本数: "+o(_.value.replicas)+"/"+o(_.value.desiredReplicas),1),a("div",null,"运行时长: "+o(_.value.uptime),1)])]),_:1})]),_:1}),e(d,{span:6},{default:t(()=>[e(u,{shadow:"hover"},{default:t(()=>[e(C,{title:"实时QPS",value:r.value.qps},{suffix:t(()=>l[4]||(l[4]=[m("req/s",-1)])),_:1},8,["value"]),a("div",Re,[a("span",{style:v({color:Z(r.value.qpsTrend)})},o(r.value.qpsTrend>0?"↑":"↓")+" "+o(Math.abs(r.value.qpsTrend))+"% ",5)])]),_:1})]),_:1}),e(d,{span:6},{default:t(()=>[e(u,{shadow:"hover"},{default:t(()=>[e(C,{title:"平均延迟",value:r.value.avgLatency},{suffix:t(()=>l[5]||(l[5]=[m("ms",-1)])),_:1},8,["value"]),a("div",Ue,[a("span",{style:v({color:z(r.value.avgLatency)})}," P99: "+o(r.value.p99Latency)+"ms ",5),a("span",{style:v([{"margin-left":"8px"},{color:z(r.value.avgLatency)}])}," P95: "+o(r.value.p95Latency)+"ms ",5)])]),_:1})]),_:1}),e(d,{span:6},{default:t(()=>[e(u,{shadow:"hover"},{default:t(()=>[e(C,{title:"成功率",value:r.value.successRate,precision:2},{suffix:t(()=>l[6]||(l[6]=[m("%",-1)])),_:1},8,["value"]),a("div",Ae,[a("span",{style:v({color:$(r.value.successRate)})}," 错误数: "+o(r.value.errorCount),5)])]),_:1})]),_:1})]),_:1}),e(L,{gutter:20,style:{"margin-bottom":"20px"}},{default:t(()=>[e(d,{span:12},{default:t(()=>[e(u,null,{header:t(()=>l[7]||(l[7]=[a("div",{class:"card-header"},[a("span",{class:"title"},"QPS趋势")],-1)])),default:t(()=>[a("div",{ref_key:"qpsTrendChartRef",ref:R,style:{width:"100%",height:"280px"}},null,512)]),_:1})]),_:1}),e(d,{span:12},{default:t(()=>[e(u,null,{header:t(()=>l[8]||(l[8]=[a("div",{class:"card-header"},[a("span",{class:"title"},"性能分位指标")],-1)])),default:t(()=>[e(ae,{modelValue:E.value,"onUpdate:modelValue":l[2]||(l[2]=s=>E.value=s),onTabChange:Y},{default:t(()=>[e(q,{label:"TTFT",name:"ttft"}),e(q,{label:"OTPS",name:"otps"}),e(q,{label:"TPOT",name:"tpot"}),e(q,{label:"E2E Latency",name:"latency"})]),_:1},8,["modelValue"]),a("div",{ref_key:"latencyDistChartRef",ref:U,style:{width:"100%",height:"280px"}},null,512)]),_:1})]),_:1})]),_:1}),e(L,{gutter:20,style:{"margin-bottom":"20px"}},{default:t(()=>[e(d,{span:12},{default:t(()=>[e(u,null,{header:t(()=>l[9]||(l[9]=[a("div",{class:"card-header"},[a("span",{class:"title"},"GPU利用率")],-1)])),default:t(()=>[a("div",{ref_key:"gpuUtilChartRef",ref:A,style:{width:"100%",height:"280px"}},null,512)]),_:1})]),_:1}),e(d,{span:12},{default:t(()=>[e(u,null,{header:t(()=>l[10]||(l[10]=[a("div",{class:"card-header"},[a("span",{class:"title"},"Token吞吐量")],-1)])),default:t(()=>[a("div",{ref_key:"tokenThroughputChartRef",ref:V,style:{width:"100%",height:"280px"}},null,512)]),_:1})]),_:1})]),_:1}),e(u,{style:{"margin-bottom":"20px"}},{header:t(()=>l[11]||(l[11]=[a("div",{class:"card-header"},[a("span",{class:"title"},"资源使用情况")],-1)])),default:t(()=>[e(L,{gutter:20},{default:t(()=>[e(d,{span:8},{default:t(()=>[a("div",Ve,[l[12]||(l[12]=a("div",{class:"resource-label"},"GPU使用率",-1)),e(P,{percentage:f.value.gpu,color:M(f.value.gpu),"stroke-width":20},null,8,["percentage","color"])])]),_:1}),e(d,{span:8},{default:t(()=>[a("div",ze,[l[13]||(l[13]=a("div",{class:"resource-label"},"内存使用率",-1)),e(P,{percentage:f.value.memory,color:M(f.value.memory),"stroke-width":20},null,8,["percentage","color"])])]),_:1}),e(d,{span:8},{default:t(()=>[a("div",Me,[l[14]||(l[14]=a("div",{class:"resource-label"},"CPU使用率",-1)),e(P,{percentage:f.value.cpu,color:M(f.value.cpu),"stroke-width":20},null,8,["percentage","color"])])]),_:1})]),_:1})]),_:1}),e(u,null,{header:t(()=>l[15]||(l[15]=[a("div",{class:"card-header"},[a("span",{class:"title"},"Pod实例监控")],-1)])),default:t(()=>[e(le,{data:J.value,border:"",style:{width:"100%"},"scrollbar-always-on":!0},{default:t(()=>[e(p,{prop:"podName",label:"Pod名称","min-width":"280","show-overflow-tooltip":""}),e(p,{prop:"status",label:"状态",width:"100",align:"center"},{default:t(({row:s})=>[e(Q,{type:s.status==="Running"?"success":"danger",size:"small"},{default:t(()=>[m(o(s.status),1)]),_:2},1032,["type"])]),_:1}),e(p,{prop:"qps",label:"QPS",width:"110",align:"center"},{default:t(({row:s})=>[m(o(s.qps)+" req/s ",1)]),_:1}),e(p,{prop:"avgLatency",label:"平均延迟",width:"120",align:"center"},{default:t(({row:s})=>[a("span",{style:v({color:z(s.avgLatency)})},o(s.avgLatency)+"ms",5)]),_:1}),e(p,{prop:"gpuUtil",label:"GPU利用率",width:"140",align:"center"},{default:t(({row:s})=>[a("div",Oe,[e(P,{percentage:s.gpuUtil,"stroke-width":6,style:{width:"60px"}},null,8,["percentage"]),a("span",Ne,o(s.gpuUtil)+"%",1)])]),_:1}),e(p,{prop:"memoryUtil",label:"内存利用率",width:"140",align:"center"},{default:t(({row:s})=>[a("div",Be,[e(P,{percentage:s.memoryUtil,"stroke-width":6,style:{width:"60px"}},null,8,["percentage"]),a("span",Ge,o(s.memoryUtil)+"%",1)])]),_:1}),e(p,{prop:"requests",label:"请求数",width:"110",align:"right"},{default:t(({row:s})=>[m(o(s.requests.toLocaleString()),1)]),_:1}),e(p,{prop:"errors",label:"错误数",width:"100",align:"right"},{default:t(({row:s})=>[a("span",{style:v({color:s.errors>0?"#f56c6c":"#67c23a"})},o(s.errors),5)]),_:1}),e(p,{prop:"uptime",label:"运行时长",width:"130"})]),_:1},8,["data"])]),_:1})])}}}),mt=me(je,[["__scopeId","data-v-5ea623eb"]]);export{mt as default};
