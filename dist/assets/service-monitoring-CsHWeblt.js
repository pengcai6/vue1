import{d as Z,r as u,h as $,b as O,o as L,f as e,w as t,F as ee,A as te,c as ae,a as c,E as le,C as se,aW as oe,e as a,t as o,I as v,aE as re,_ as ne}from"./index-C1LNxWrc.js";import{E as ie,a as ue}from"./table-column-QOtjyKSd.js";import"./checkbox-D429Hkk4.js";import"./scrollbar-CWDB5A-B.js";/* empty css            */import{E as pe}from"./progress-D7FpNBk1.js";import{E as de,a as ce}from"./col-BHj47XkZ.js";import{E as me}from"./statistic-D5rvesja.js";import{E as fe}from"./card-bOHwtd_N.js";import{E as ge,a as _e}from"./form-item-BZC8dQDK.js";import{E as ve}from"./button-CfgjJGa2.js";import{E as ye,a as he}from"./select-BSsX693L.js";import{i as x}from"./index-C3W-oE5n.js";import{E as be}from"./index-gsKI2Iim.js";import{E as z}from"./index-JFsgmBjq.js";import"./index-DRLRXOGd.js";import"./_initCloneObject-T9RaIEd1.js";import"./isPlainObject-BS8VhLgB.js";import"./_baseIteratee-CNffayvf.js";import"./isEqual-CFwnnDW_.js";import"./debounce-C4p0xsPh.js";import"./use-form-common-props-dMO5F-Xy.js";import"./_baseClone-0EgoVDGI.js";import"./strings-BOPxCUMK.js";import"./index-BPEUnmM4.js";import"./scroll-RLo4NxSV.js";const xe={class:"service-monitoring-page"},we={class:"status-detail"},Ce={class:"metric-detail"},Ee={class:"metric-detail"},Se={class:"metric-detail"},qe={class:"resource-item"},Pe={class:"resource-item"},Te={class:"resource-item"},Re={style:{display:"flex","align-items":"center","justify-content":"center"}},Ue={style:{"margin-left":"8px","white-space":"nowrap"}},ke={style:{display:"flex","align-items":"center","justify-content":"center"}},Le={style:{"margin-left":"8px","white-space":"nowrap"}},ze=Z({__name:"service-monitoring",setup(Ae){const D=u([{id:"service-001",name:"qwen-chat-api"},{id:"service-002",name:"deepseek-inference"},{id:"service-003",name:"glm-service"}]),A=u("service-001"),V=u("1h"),f=u({status:"running",replicas:3,desiredReplicas:3,uptime:"15天 8小时"}),p=u({qps:245,qpsTrend:12.5,avgLatency:1234,p99Latency:2567,successRate:99.2,errorCount:23}),m=u({gpu:78,memory:65,cpu:42}),F=u([{podName:"qwen-chat-api-deployment-7d9f8b6c5-abc12",status:"Running",qps:82,avgLatency:1189,gpuUtil:75,memoryUtil:62,requests:145678,errors:8,uptime:"15天 8小时"},{podName:"qwen-chat-api-deployment-7d9f8b6c5-def34",status:"Running",qps:85,avgLatency:1256,gpuUtil:79,memoryUtil:67,requests:152341,errors:9,uptime:"15天 8小时"},{podName:"qwen-chat-api-deployment-7d9f8b6c5-ghi56",status:"Running",qps:78,avgLatency:1267,gpuUtil:80,memoryUtil:66,requests:138954,errors:6,uptime:"15天 8小时"}]),w=u(),C=u(),E=u(),S=u();let q=null,P=null,T=null,R=null;const G=()=>{z.success("已切换服务"),y()},I=()=>{z.success("已更新时间范围"),y()},Q=()=>{z.success("数据已刷新"),y()},y=async()=>{await re(),w.value&&(q=x(w.value),q.setOption({tooltip:{trigger:"axis"},grid:{left:"3%",right:"4%",bottom:"3%",top:"10%",containLabel:!0},xAxis:{type:"category",data:["00:00","04:00","08:00","12:00","16:00","20:00","23:59"]},yAxis:{type:"value",name:"req/s"},series:[{name:"QPS",type:"line",smooth:!0,data:[156,189,234,278,312,289,245],itemStyle:{color:"#409eff"},areaStyle:{color:"rgba(64, 158, 255, 0.2)"}}]})),C.value&&(P=x(C.value),P.setOption({tooltip:{trigger:"axis"},legend:{data:["P50","P90","P99"],top:"0%"},grid:{left:"3%",right:"4%",bottom:"3%",top:"12%",containLabel:!0},xAxis:{type:"category",data:["00:00","04:00","08:00","12:00","16:00","20:00","23:59"]},yAxis:{type:"value",name:"ms"},series:[{name:"P50",type:"line",smooth:!0,data:[892,945,1023,1156,1234,1178,1089],itemStyle:{color:"#67c23a"}},{name:"P90",type:"line",smooth:!0,data:[1456,1523,1678,1823,1945,1867,1734],itemStyle:{color:"#e6a23c"}},{name:"P99",type:"line",smooth:!0,data:[2134,2267,2456,2678,2834,2723,2567],itemStyle:{color:"#f56c6c"}}]})),E.value&&(T=x(E.value),T.setOption({tooltip:{trigger:"axis"},grid:{left:"50px",right:"50px",bottom:"3%",top:"10%",containLabel:!0},xAxis:{type:"category",data:["00:00","04:00","08:00","12:00","16:00","20:00","23:59"]},yAxis:{type:"value",name:"%",max:100},series:[{name:"GPU利用率",type:"line",smooth:!0,data:[68,72,75,82,85,81,78],itemStyle:{color:"#e6a23c"},areaStyle:{color:"rgba(230, 162, 60, 0.2)"},markLine:{data:[{type:"average",name:"平均值"}],lineStyle:{color:"#f56c6c",type:"dashed"},label:{show:!0,position:"insideEndTop",formatter:"平均值: {c}%"}}}]})),S.value&&(R=x(S.value),R.setOption({tooltip:{trigger:"axis"},legend:{data:["输入TPS","输出TPS"],top:"0%"},grid:{left:"3%",right:"4%",bottom:"3%",top:"12%",containLabel:!0},xAxis:{type:"category",data:["00:00","04:00","08:00","12:00","16:00","20:00","23:59"]},yAxis:{type:"value",name:"tokens/s"},series:[{name:"输入TPS",type:"bar",data:[3456,3678,4123,4567,4890,4623,4234],itemStyle:{color:"#67c23a"}},{name:"输出TPS",type:"bar",data:[8923,9456,10345,11234,12056,11678,10789],itemStyle:{color:"#409eff"}}]}))},j=r=>r>0?"#67c23a":"#f56c6c",N=r=>r<1e3?"#67c23a":r<2e3?"#e6a23c":"#f56c6c",W=r=>r>=99?"#67c23a":r>=95?"#e6a23c":"#f56c6c",U=r=>r<70?"#67c23a":r<85?"#e6a23c":"#f56c6c",H=()=>{q?.resize(),P?.resize(),T?.resize(),R?.resize()};return $(()=>{y(),window.addEventListener("resize",H)}),(r,l)=>{const g=he,M=ye,k=_e,J=le,K=ve,X=ge,n=fe,B=be,h=me,i=de,b=ce,_=pe,d=ue,Y=ie;return L(),O("div",xe,[e(n,{style:{"margin-bottom":"20px"}},{default:t(()=>[e(X,{inline:!0},{default:t(()=>[e(k,{label:"选择服务"},{default:t(()=>[e(M,{modelValue:A.value,"onUpdate:modelValue":l[0]||(l[0]=s=>A.value=s),placeholder:"请选择服务",onChange:G,style:{width:"200px"}},{default:t(()=>[(L(!0),O(ee,null,te(D.value,s=>(L(),ae(g,{key:s.id,label:s.name,value:s.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(k,{label:"时间范围"},{default:t(()=>[e(M,{modelValue:V.value,"onUpdate:modelValue":l[1]||(l[1]=s=>V.value=s),onChange:I,style:{width:"150px"}},{default:t(()=>[e(g,{label:"最近1小时",value:"1h"}),e(g,{label:"最近6小时",value:"6h"}),e(g,{label:"最近24小时",value:"24h"}),e(g,{label:"最近7天",value:"7d"})]),_:1},8,["modelValue"])]),_:1}),e(k,null,{default:t(()=>[e(K,{type:"primary",onClick:Q},{default:t(()=>[e(J,null,{default:t(()=>[e(se(oe))]),_:1}),l[2]||(l[2]=c(" 刷新 ",-1))]),_:1,__:[2]})]),_:1})]),_:1})]),_:1}),e(b,{gutter:20,style:{"margin-bottom":"20px"}},{default:t(()=>[e(i,{span:6},{default:t(()=>[e(n,{shadow:"hover"},{default:t(()=>[e(h,{title:"服务状态"},{default:t(()=>[e(B,{type:f.value.status==="running"?"success":"danger",size:"large"},{default:t(()=>[c(o(f.value.status==="running"?"运行中":"异常"),1)]),_:1},8,["type"])]),_:1}),a("div",we,[a("div",null,"副本数: "+o(f.value.replicas)+"/"+o(f.value.desiredReplicas),1),a("div",null,"运行时长: "+o(f.value.uptime),1)])]),_:1})]),_:1}),e(i,{span:6},{default:t(()=>[e(n,{shadow:"hover"},{default:t(()=>[e(h,{title:"实时QPS",value:p.value.qps},{suffix:t(()=>l[3]||(l[3]=[c("req/s",-1)])),_:1},8,["value"]),a("div",Ce,[a("span",{style:v({color:j(p.value.qpsTrend)})},o(p.value.qpsTrend>0?"↑":"↓")+" "+o(Math.abs(p.value.qpsTrend))+"% ",5)])]),_:1})]),_:1}),e(i,{span:6},{default:t(()=>[e(n,{shadow:"hover"},{default:t(()=>[e(h,{title:"平均延迟",value:p.value.avgLatency},{suffix:t(()=>l[4]||(l[4]=[c("ms",-1)])),_:1},8,["value"]),a("div",Ee,[a("span",{style:v({color:N(p.value.avgLatency)})}," P99: "+o(p.value.p99Latency)+"ms ",5)])]),_:1})]),_:1}),e(i,{span:6},{default:t(()=>[e(n,{shadow:"hover"},{default:t(()=>[e(h,{title:"成功率",value:p.value.successRate,precision:2},{suffix:t(()=>l[5]||(l[5]=[c("%",-1)])),_:1},8,["value"]),a("div",Se,[a("span",{style:v({color:W(p.value.successRate)})}," 错误数: "+o(p.value.errorCount),5)])]),_:1})]),_:1})]),_:1}),e(b,{gutter:20,style:{"margin-bottom":"20px"}},{default:t(()=>[e(i,{span:12},{default:t(()=>[e(n,null,{header:t(()=>l[6]||(l[6]=[a("div",{class:"card-header"},[a("span",{class:"title"},"QPS趋势")],-1)])),default:t(()=>[a("div",{ref_key:"qpsTrendChartRef",ref:w,style:{width:"100%",height:"280px"}},null,512)]),_:1})]),_:1}),e(i,{span:12},{default:t(()=>[e(n,null,{header:t(()=>l[7]||(l[7]=[a("div",{class:"card-header"},[a("span",{class:"title"},"延迟分布")],-1)])),default:t(()=>[a("div",{ref_key:"latencyDistChartRef",ref:C,style:{width:"100%",height:"280px"}},null,512)]),_:1})]),_:1})]),_:1}),e(b,{gutter:20,style:{"margin-bottom":"20px"}},{default:t(()=>[e(i,{span:12},{default:t(()=>[e(n,null,{header:t(()=>l[8]||(l[8]=[a("div",{class:"card-header"},[a("span",{class:"title"},"GPU利用率")],-1)])),default:t(()=>[a("div",{ref_key:"gpuUtilChartRef",ref:E,style:{width:"100%",height:"280px"}},null,512)]),_:1})]),_:1}),e(i,{span:12},{default:t(()=>[e(n,null,{header:t(()=>l[9]||(l[9]=[a("div",{class:"card-header"},[a("span",{class:"title"},"Token吞吐量")],-1)])),default:t(()=>[a("div",{ref_key:"tokenThroughputChartRef",ref:S,style:{width:"100%",height:"280px"}},null,512)]),_:1})]),_:1})]),_:1}),e(n,{style:{"margin-bottom":"20px"}},{header:t(()=>l[10]||(l[10]=[a("div",{class:"card-header"},[a("span",{class:"title"},"资源使用情况")],-1)])),default:t(()=>[e(b,{gutter:20},{default:t(()=>[e(i,{span:8},{default:t(()=>[a("div",qe,[l[11]||(l[11]=a("div",{class:"resource-label"},"GPU使用率",-1)),e(_,{percentage:m.value.gpu,color:U(m.value.gpu),"stroke-width":20},null,8,["percentage","color"])])]),_:1}),e(i,{span:8},{default:t(()=>[a("div",Pe,[l[12]||(l[12]=a("div",{class:"resource-label"},"内存使用率",-1)),e(_,{percentage:m.value.memory,color:U(m.value.memory),"stroke-width":20},null,8,["percentage","color"])])]),_:1}),e(i,{span:8},{default:t(()=>[a("div",Te,[l[13]||(l[13]=a("div",{class:"resource-label"},"CPU使用率",-1)),e(_,{percentage:m.value.cpu,color:U(m.value.cpu),"stroke-width":20},null,8,["percentage","color"])])]),_:1})]),_:1})]),_:1}),e(n,null,{header:t(()=>l[14]||(l[14]=[a("div",{class:"card-header"},[a("span",{class:"title"},"Pod实例监控")],-1)])),default:t(()=>[e(Y,{data:F.value,border:"",style:{width:"100%"},"scrollbar-always-on":!0},{default:t(()=>[e(d,{prop:"podName",label:"Pod名称","min-width":"280","show-overflow-tooltip":""}),e(d,{prop:"status",label:"状态",width:"100",align:"center"},{default:t(({row:s})=>[e(B,{type:s.status==="Running"?"success":"danger",size:"small"},{default:t(()=>[c(o(s.status),1)]),_:2},1032,["type"])]),_:1}),e(d,{prop:"qps",label:"QPS",width:"110",align:"center"},{default:t(({row:s})=>[c(o(s.qps)+" req/s ",1)]),_:1}),e(d,{prop:"avgLatency",label:"平均延迟",width:"120",align:"center"},{default:t(({row:s})=>[a("span",{style:v({color:N(s.avgLatency)})},o(s.avgLatency)+"ms",5)]),_:1}),e(d,{prop:"gpuUtil",label:"GPU利用率",width:"140",align:"center"},{default:t(({row:s})=>[a("div",Re,[e(_,{percentage:s.gpuUtil,"stroke-width":6,style:{width:"60px"}},null,8,["percentage"]),a("span",Ue,o(s.gpuUtil)+"%",1)])]),_:1}),e(d,{prop:"memoryUtil",label:"内存利用率",width:"140",align:"center"},{default:t(({row:s})=>[a("div",ke,[e(_,{percentage:s.memoryUtil,"stroke-width":6,style:{width:"60px"}},null,8,["percentage"]),a("span",Le,o(s.memoryUtil)+"%",1)])]),_:1}),e(d,{prop:"requests",label:"请求数",width:"110",align:"right"},{default:t(({row:s})=>[c(o(s.requests.toLocaleString()),1)]),_:1}),e(d,{prop:"errors",label:"错误数",width:"100",align:"right"},{default:t(({row:s})=>[a("span",{style:v({color:s.errors>0?"#f56c6c":"#67c23a"})},o(s.errors),5)]),_:1}),e(d,{prop:"uptime",label:"运行时长",width:"130"})]),_:1},8,["data"])]),_:1})])}}}),nt=ne(ze,[["__scopeId","data-v-49d084f9"]]);export{nt as default};
