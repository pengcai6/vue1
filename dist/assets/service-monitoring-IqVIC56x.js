import{d as Z,r as u,j as $,c as F,a as e,w as t,aF as ee,o as T,F as te,D as ae,i as c,E as le,e as se,bd as oe,b as a,n as o,J as x,l as re}from"./index-DAZDpghP.js";import{a as ne,E as ie}from"./table-column-CkszfM6q.js";import"./checkbox-DDntw5na.js";import"./scrollbar-BKn1N4ug.js";/* empty css            */import{E as ue}from"./progress-CA3fGClE.js";import{E as de,a as pe}from"./col-1pbAQj7U.js";import{E as ce}from"./statistic-CqMGJr7U.js";import{E as me}from"./card-_e8Y2itV.js";import{E as fe,a as ge}from"./form-item-D50nbGgb.js";import{E as _e}from"./button-CFFx6FdR.js";import{E as ve,a as ye}from"./select-B_Nc0zOl.js";import{i as q}from"./index-C3W-oE5n.js";import{E as he}from"./index-i9SNigSW.js";import{E as z}from"./index-B4p_U5VT.js";import{_ as be}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./event-D5_Wo8Xc.js";import"./isPlainObject-CnEW4LJ3.js";import"./_baseIteratee-DgY2c_zD.js";import"./isEqual-DlB8YXyV.js";import"./debounce-Bv_84CHO.js";import"./index-17xiCnpu.js";import"./_baseClone-BBryStzM.js";import"./strings-BN0-5NCg.js";import"./scroll-PXqKi88e.js";const xe={class:"service-monitoring-page"},we={class:"status-detail"},Ee={class:"metric-detail"},Se={class:"metric-detail"},qe={class:"metric-detail"},Pe={class:"resource-item"},Re={class:"resource-item"},Ce={class:"resource-item"},Ue={style:{display:"flex","align-items":"center","justify-content":"center"}},ke={style:{"margin-left":"8px","white-space":"nowrap"}},Le={style:{display:"flex","align-items":"center","justify-content":"center"}},Te={style:{"margin-left":"8px","white-space":"nowrap"}},ze=Z({__name:"service-monitoring",setup(Ve){const O=u([{id:"service-001",name:"qwen-chat-api"},{id:"service-002",name:"deepseek-inference"},{id:"service-003",name:"glm-service"}]),V=u("service-001"),A=u("1h"),f=u({status:"running",replicas:3,desiredReplicas:3,uptime:"15天 8小时"}),d=u({qps:245,qpsTrend:12.5,avgLatency:1234,p99Latency:2567,successRate:99.2,errorCount:23}),m=u({gpu:78,memory:65,cpu:42}),G=u([{podName:"qwen-chat-api-deployment-7d9f8b6c5-abc12",status:"Running",qps:82,avgLatency:1189,gpuUtil:75,memoryUtil:62,requests:145678,errors:8,uptime:"15天 8小时"},{podName:"qwen-chat-api-deployment-7d9f8b6c5-def34",status:"Running",qps:85,avgLatency:1256,gpuUtil:79,memoryUtil:67,requests:152341,errors:9,uptime:"15天 8小时"},{podName:"qwen-chat-api-deployment-7d9f8b6c5-ghi56",status:"Running",qps:78,avgLatency:1267,gpuUtil:80,memoryUtil:66,requests:138954,errors:6,uptime:"15天 8小时"}]),P=u(),R=u(),C=u(),U=u();let g=null,_=null,v=null,y=null;const Q=()=>{z.success("已切换服务"),w()},j=()=>{z.success("已更新时间范围"),w()},D=()=>{z.success("数据已刷新"),w()},w=async()=>{await ee(),P.value&&(g=q(P.value),g.setOption({tooltip:{trigger:"axis"},grid:{left:"3%",right:"4%",bottom:"3%",top:"10%",containLabel:!0},xAxis:{type:"category",data:["00:00","04:00","08:00","12:00","16:00","20:00","23:59"]},yAxis:{type:"value",name:"req/s"},series:[{name:"QPS",type:"line",smooth:!0,data:[156,189,234,278,312,289,245],itemStyle:{color:"#409eff"},areaStyle:{color:"rgba(64, 158, 255, 0.2)"}}]})),R.value&&(_=q(R.value),_.setOption({tooltip:{trigger:"axis"},legend:{data:["P50","P90","P99"],top:"0%"},grid:{left:"3%",right:"4%",bottom:"3%",top:"12%",containLabel:!0},xAxis:{type:"category",data:["00:00","04:00","08:00","12:00","16:00","20:00","23:59"]},yAxis:{type:"value",name:"ms"},series:[{name:"P50",type:"line",smooth:!0,data:[892,945,1023,1156,1234,1178,1089],itemStyle:{color:"#67c23a"}},{name:"P90",type:"line",smooth:!0,data:[1456,1523,1678,1823,1945,1867,1734],itemStyle:{color:"#e6a23c"}},{name:"P99",type:"line",smooth:!0,data:[2134,2267,2456,2678,2834,2723,2567],itemStyle:{color:"#f56c6c"}}]})),C.value&&(v=q(C.value),v.setOption({tooltip:{trigger:"axis"},grid:{left:"50px",right:"50px",bottom:"3%",top:"10%",containLabel:!0},xAxis:{type:"category",data:["00:00","04:00","08:00","12:00","16:00","20:00","23:59"]},yAxis:{type:"value",name:"%",max:100},series:[{name:"GPU利用率",type:"line",smooth:!0,data:[68,72,75,82,85,81,78],itemStyle:{color:"#e6a23c"},areaStyle:{color:"rgba(230, 162, 60, 0.2)"},markLine:{data:[{type:"average",name:"平均值"}],lineStyle:{color:"#f56c6c",type:"dashed"},label:{show:!0,position:"insideEndTop",formatter:"平均值: {c}%"}}}]})),U.value&&(y=q(U.value),y.setOption({tooltip:{trigger:"axis"},legend:{data:["输入TPS","输出TPS"],top:"0%"},grid:{left:"3%",right:"4%",bottom:"3%",top:"12%",containLabel:!0},xAxis:{type:"category",data:["00:00","04:00","08:00","12:00","16:00","20:00","23:59"]},yAxis:{type:"value",name:"tokens/s"},series:[{name:"输入TPS",type:"bar",data:[3456,3678,4123,4567,4890,4623,4234],itemStyle:{color:"#67c23a"}},{name:"输出TPS",type:"bar",data:[8923,9456,10345,11234,12056,11678,10789],itemStyle:{color:"#409eff"}}]}))},I=r=>r>0?"#67c23a":"#f56c6c",N=r=>r<1e3?"#67c23a":r<2e3?"#e6a23c":"#f56c6c",J=r=>r>=99?"#67c23a":r>=95?"#e6a23c":"#f56c6c",k=r=>r<70?"#67c23a":r<85?"#e6a23c":"#f56c6c",H=()=>{g==null||g.resize(),_==null||_.resize(),v==null||v.resize(),y==null||y.resize()};return $(()=>{w(),window.addEventListener("resize",H)}),(r,l)=>{const h=ye,M=ve,L=ge,K=le,W=_e,X=fe,n=me,B=he,E=ce,i=pe,S=de,b=ue,p=ie,Y=ne;return T(),F("div",xe,[e(n,{style:{"margin-bottom":"20px"}},{default:t(()=>[e(X,{inline:!0},{default:t(()=>[e(L,{label:"选择服务"},{default:t(()=>[e(M,{modelValue:V.value,"onUpdate:modelValue":l[0]||(l[0]=s=>V.value=s),placeholder:"请选择服务",onChange:Q,style:{width:"200px"}},{default:t(()=>[(T(!0),F(te,null,ae(O.value,s=>(T(),re(h,{key:s.id,label:s.name,value:s.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(L,{label:"时间范围"},{default:t(()=>[e(M,{modelValue:A.value,"onUpdate:modelValue":l[1]||(l[1]=s=>A.value=s),onChange:j,style:{width:"150px"}},{default:t(()=>[e(h,{label:"最近1小时",value:"1h"}),e(h,{label:"最近6小时",value:"6h"}),e(h,{label:"最近24小时",value:"24h"}),e(h,{label:"最近7天",value:"7d"})]),_:1},8,["modelValue"])]),_:1}),e(L,null,{default:t(()=>[e(W,{type:"primary",onClick:D},{default:t(()=>[e(K,null,{default:t(()=>[e(se(oe))]),_:1}),l[2]||(l[2]=c(" 刷新 ",-1))]),_:1,__:[2]})]),_:1})]),_:1})]),_:1}),e(S,{gutter:20,style:{"margin-bottom":"20px"}},{default:t(()=>[e(i,{span:6},{default:t(()=>[e(n,{shadow:"hover"},{default:t(()=>[e(E,{title:"服务状态"},{default:t(()=>[e(B,{type:f.value.status==="running"?"success":"danger",size:"large"},{default:t(()=>[c(o(f.value.status==="running"?"运行中":"异常"),1)]),_:1},8,["type"])]),_:1}),a("div",we,[a("div",null,"副本数: "+o(f.value.replicas)+"/"+o(f.value.desiredReplicas),1),a("div",null,"运行时长: "+o(f.value.uptime),1)])]),_:1})]),_:1}),e(i,{span:6},{default:t(()=>[e(n,{shadow:"hover"},{default:t(()=>[e(E,{title:"实时QPS",value:d.value.qps},{suffix:t(()=>l[3]||(l[3]=[c("req/s",-1)])),_:1},8,["value"]),a("div",Ee,[a("span",{style:x({color:I(d.value.qpsTrend)})},o(d.value.qpsTrend>0?"↑":"↓")+" "+o(Math.abs(d.value.qpsTrend))+"% ",5)])]),_:1})]),_:1}),e(i,{span:6},{default:t(()=>[e(n,{shadow:"hover"},{default:t(()=>[e(E,{title:"平均延迟",value:d.value.avgLatency},{suffix:t(()=>l[4]||(l[4]=[c("ms",-1)])),_:1},8,["value"]),a("div",Se,[a("span",{style:x({color:N(d.value.avgLatency)})}," P99: "+o(d.value.p99Latency)+"ms ",5)])]),_:1})]),_:1}),e(i,{span:6},{default:t(()=>[e(n,{shadow:"hover"},{default:t(()=>[e(E,{title:"成功率",value:d.value.successRate,precision:2},{suffix:t(()=>l[5]||(l[5]=[c("%",-1)])),_:1},8,["value"]),a("div",qe,[a("span",{style:x({color:J(d.value.successRate)})}," 错误数: "+o(d.value.errorCount),5)])]),_:1})]),_:1})]),_:1}),e(S,{gutter:20,style:{"margin-bottom":"20px"}},{default:t(()=>[e(i,{span:12},{default:t(()=>[e(n,null,{header:t(()=>l[6]||(l[6]=[a("div",{class:"card-header"},[a("span",{class:"title"},"QPS趋势")],-1)])),default:t(()=>[a("div",{ref_key:"qpsTrendChartRef",ref:P,style:{width:"100%",height:"280px"}},null,512)]),_:1})]),_:1}),e(i,{span:12},{default:t(()=>[e(n,null,{header:t(()=>l[7]||(l[7]=[a("div",{class:"card-header"},[a("span",{class:"title"},"延迟分布")],-1)])),default:t(()=>[a("div",{ref_key:"latencyDistChartRef",ref:R,style:{width:"100%",height:"280px"}},null,512)]),_:1})]),_:1})]),_:1}),e(S,{gutter:20,style:{"margin-bottom":"20px"}},{default:t(()=>[e(i,{span:12},{default:t(()=>[e(n,null,{header:t(()=>l[8]||(l[8]=[a("div",{class:"card-header"},[a("span",{class:"title"},"GPU利用率")],-1)])),default:t(()=>[a("div",{ref_key:"gpuUtilChartRef",ref:C,style:{width:"100%",height:"280px"}},null,512)]),_:1})]),_:1}),e(i,{span:12},{default:t(()=>[e(n,null,{header:t(()=>l[9]||(l[9]=[a("div",{class:"card-header"},[a("span",{class:"title"},"Token吞吐量")],-1)])),default:t(()=>[a("div",{ref_key:"tokenThroughputChartRef",ref:U,style:{width:"100%",height:"280px"}},null,512)]),_:1})]),_:1})]),_:1}),e(n,{style:{"margin-bottom":"20px"}},{header:t(()=>l[10]||(l[10]=[a("div",{class:"card-header"},[a("span",{class:"title"},"资源使用情况")],-1)])),default:t(()=>[e(S,{gutter:20},{default:t(()=>[e(i,{span:8},{default:t(()=>[a("div",Pe,[l[11]||(l[11]=a("div",{class:"resource-label"},"GPU使用率",-1)),e(b,{percentage:m.value.gpu,color:k(m.value.gpu),"stroke-width":20},null,8,["percentage","color"])])]),_:1}),e(i,{span:8},{default:t(()=>[a("div",Re,[l[12]||(l[12]=a("div",{class:"resource-label"},"内存使用率",-1)),e(b,{percentage:m.value.memory,color:k(m.value.memory),"stroke-width":20},null,8,["percentage","color"])])]),_:1}),e(i,{span:8},{default:t(()=>[a("div",Ce,[l[13]||(l[13]=a("div",{class:"resource-label"},"CPU使用率",-1)),e(b,{percentage:m.value.cpu,color:k(m.value.cpu),"stroke-width":20},null,8,["percentage","color"])])]),_:1})]),_:1})]),_:1}),e(n,null,{header:t(()=>l[14]||(l[14]=[a("div",{class:"card-header"},[a("span",{class:"title"},"Pod实例监控")],-1)])),default:t(()=>[e(Y,{data:G.value,border:"",style:{width:"100%"},"scrollbar-always-on":!0},{default:t(()=>[e(p,{prop:"podName",label:"Pod名称","min-width":"280","show-overflow-tooltip":""}),e(p,{prop:"status",label:"状态",width:"100",align:"center"},{default:t(({row:s})=>[e(B,{type:s.status==="Running"?"success":"danger",size:"small"},{default:t(()=>[c(o(s.status),1)]),_:2},1032,["type"])]),_:1}),e(p,{prop:"qps",label:"QPS",width:"110",align:"center"},{default:t(({row:s})=>[c(o(s.qps)+" req/s ",1)]),_:1}),e(p,{prop:"avgLatency",label:"平均延迟",width:"120",align:"center"},{default:t(({row:s})=>[a("span",{style:x({color:N(s.avgLatency)})},o(s.avgLatency)+"ms",5)]),_:1}),e(p,{prop:"gpuUtil",label:"GPU利用率",width:"140",align:"center"},{default:t(({row:s})=>[a("div",Ue,[e(b,{percentage:s.gpuUtil,"stroke-width":6,style:{width:"60px"}},null,8,["percentage"]),a("span",ke,o(s.gpuUtil)+"%",1)])]),_:1}),e(p,{prop:"memoryUtil",label:"内存利用率",width:"140",align:"center"},{default:t(({row:s})=>[a("div",Le,[e(b,{percentage:s.memoryUtil,"stroke-width":6,style:{width:"60px"}},null,8,["percentage"]),a("span",Te,o(s.memoryUtil)+"%",1)])]),_:1}),e(p,{prop:"requests",label:"请求数",width:"110",align:"right"},{default:t(({row:s})=>[c(o(s.requests.toLocaleString()),1)]),_:1}),e(p,{prop:"errors",label:"错误数",width:"100",align:"right"},{default:t(({row:s})=>[a("span",{style:x({color:s.errors>0?"#f56c6c":"#67c23a"})},o(s.errors),5)]),_:1}),e(p,{prop:"uptime",label:"运行时长",width:"130"})]),_:1},8,["data"])]),_:1})])}}}),rt=be(ze,[["__scopeId","data-v-49d084f9"]]);export{rt as default};
