import{d as $,r as v,j as P,c as Y,a as t,w as a,ag as G,o as Q,i as s,E as W,e as w,bf as H,b as o,bN as E,p as c,L as J,l as O,_ as K}from"./index-BX2sZVyW.js";import{a as X,E as Z}from"./table-column-DG__lvqo.js";import"./checkbox-B8dDd1Mj.js";import"./scrollbar-C9NSq6wy.js";/* empty css            */import{E as ee,a as te}from"./col-DfCBUvxB.js";import{E as ae}from"./statistic-BIQ42bG3.js";import{E as oe}from"./card-B6phTZGW.js";import{E as le,a as ne}from"./form-item-BCUJoI1X.js";import{a as se,E as re}from"./button-Cn9gqGCu.js";import{E as ie}from"./date-picker-CMS_m3WO.js";import"./input-5aB7ALv6.js";import{i as R}from"./index-C3W-oE5n.js";import{E as de}from"./index-BFcHm1-Q.js";import"./event-BORzi4vc.js";import"./isPlainObject-jZyBOBeK.js";import"./debounce-DYp1oJWc.js";import"./index-PwB6y63X.js";import"./isEqual-ohjdCfDM.js";import"./_baseClone-BOpOh07B.js";import"./index-BDj3Pv7k.js";const ue={class:"operational-report-page"},pe={class:"metric-trend"},ce={class:"metric-trend"},me={class:"metric-trend"},fe={class:"metric-trend"},ge=$({__name:"operational-report",setup(ve){const C=v([new Date(new Date().getTime()-6048e5),new Date]),T=v({totalCalls:1245680,activeUsers:3542,totalTokens:8967.5,revenue:456789.25}),A=v([{serviceName:"qwen-chat-api",calls:523456,successRate:99.2,avgLatency:1234,inputTokens:4567e4,outputTokens:12345e4,totalTokens:16912e4,cost:84560,revenue:169120,margin:50},{serviceName:"deepseek-inference",calls:412389,successRate:98.8,avgLatency:2156,inputTokens:3892e4,outputTokens:9876e4,totalTokens:13768e4,cost:68840,revenue:137680,margin:50},{serviceName:"glm-service",calls:309835,successRate:99.5,avgLatency:1567,inputTokens:2934e4,outputTokens:7456e4,totalTokens:1039e5,cost:51950,revenue:103900,margin:50}]),L=v(),S=v(),D=v(),F=v();let _=null,y=null,k=null,b=null;const x=m=>{const e=new Date;let r;switch(m){case"today":r=new Date(e.getFullYear(),e.getMonth(),e.getDate());break;case"week":r=new Date(e.getTime()-7*24*60*60*1e3);break;case"month":r=new Date(e.getFullYear(),e.getMonth(),1);break;case"quarter":const f=Math.floor(e.getMonth()/3);r=new Date(e.getFullYear(),f*3,1);break;default:r=new Date(e.getTime()-7*24*60*60*1e3)}C.value=[r,e],N()},N=()=>{O.success("数据已更新"),z()},U=()=>{const m=["服务名称","调用次数","成功率(%)","平均延迟(ms)","输入Tokens","输出Tokens","总Tokens","成本(¥)","营收(¥)","毛利率(%)"],e=A.value.map(n=>[n.serviceName,n.calls,n.successRate,n.avgLatency,n.inputTokens,n.outputTokens,n.totalTokens,n.cost,n.revenue,n.margin]),r=[m.join(","),...e.map(n=>n.join(","))].join(`
`),f=new Blob(["\uFEFF"+r],{type:"text/csv;charset=utf-8;"}),u=URL.createObjectURL(f),g=document.createElement("a");g.href=u,g.download=`operational-report-${Date.now()}.csv`,document.body.appendChild(g),g.click(),document.body.removeChild(g),URL.revokeObjectURL(u),O.success("运营报告导出成功")},z=async()=>{await G(),L.value&&(_=R(L.value),_.setOption({tooltip:{trigger:"axis"},grid:{left:"3%",right:"4%",bottom:"3%",top:"10%",containLabel:!0},xAxis:{type:"category",data:["周一","周二","周三","周四","周五","周六","周日"]},yAxis:{type:"value"},series:[{name:"API调用次数",type:"line",smooth:!0,data:[165420,178930,192340,188670,201450,215890,223680],itemStyle:{color:"#409eff"},areaStyle:{color:"rgba(64, 158, 255, 0.1)"}}]})),S.value&&(y=R(S.value),y.setOption({tooltip:{trigger:"axis"},legend:{data:["输入Tokens","输出Tokens"],top:"0%"},grid:{left:"3%",right:"4%",bottom:"3%",top:"12%",containLabel:!0},xAxis:{type:"category",data:["周一","周二","周三","周四","周五","周六","周日"]},yAxis:{type:"value",name:"百万tokens"},series:[{name:"输入Tokens",type:"bar",stack:"tokens",data:[345,367,389,378,402,425,438],itemStyle:{color:"#67c23a"}},{name:"输出Tokens",type:"bar",stack:"tokens",data:[876,923,982,956,1015,1078,1109],itemStyle:{color:"#409eff"}}]})),D.value&&(k=R(D.value),k.setOption({tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{orient:"vertical",left:"left"},series:[{name:"服务调用",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!0,formatter:"{b}: {d}%"},data:[{value:523456,name:"qwen-chat-api",itemStyle:{color:"#409eff"}},{value:412389,name:"deepseek-inference",itemStyle:{color:"#67c23a"}},{value:309835,name:"glm-service",itemStyle:{color:"#e6a23c"}}]}]})),F.value&&(b=R(F.value),b.setOption({tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:["成本","营收"],top:"0%"},grid:{left:"3%",right:"4%",bottom:"3%",top:"12%",containLabel:!0},xAxis:{type:"category",data:["qwen-chat-api","deepseek-inference","glm-service"]},yAxis:{type:"value",name:"金额(¥)"},series:[{name:"成本",type:"bar",data:[84560,68840,51950],itemStyle:{color:"#f56c6c"}},{name:"营收",type:"bar",data:[169120,137680,103900],itemStyle:{color:"#67c23a"}}]}))},j=m=>m>=50?"#67c23a":m>=30?"#e6a23c":"#f56c6c",q=()=>{_==null||_.resize(),y==null||y.resize(),k==null||k.resize(),b==null||b.resize()};return P(()=>{z(),window.addEventListener("resize",q)}),(m,e)=>{const r=ie,f=ne,u=re,g=se,n=W,B=le,i=oe,h=ae,p=te,M=ee,d=Z,V=de,I=X;return Q(),Y("div",ue,[t(i,{style:{"margin-bottom":"20px"}},{default:a(()=>[t(B,{inline:!0},{default:a(()=>[t(f,{label:"报告周期"},{default:a(()=>[t(r,{modelValue:C.value,"onUpdate:modelValue":e[0]||(e[0]=l=>C.value=l),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",style:{width:"350px"},onChange:N},null,8,["modelValue"])]),_:1}),t(f,null,{default:a(()=>[t(g,null,{default:a(()=>[t(u,{onClick:e[1]||(e[1]=l=>x("today"))},{default:a(()=>e[5]||(e[5]=[s("今日",-1)])),_:1,__:[5]}),t(u,{onClick:e[2]||(e[2]=l=>x("week"))},{default:a(()=>e[6]||(e[6]=[s("本周",-1)])),_:1,__:[6]}),t(u,{onClick:e[3]||(e[3]=l=>x("month"))},{default:a(()=>e[7]||(e[7]=[s("本月",-1)])),_:1,__:[7]}),t(u,{onClick:e[4]||(e[4]=l=>x("quarter"))},{default:a(()=>e[8]||(e[8]=[s("本季度",-1)])),_:1,__:[8]})]),_:1})]),_:1}),t(f,null,{default:a(()=>[t(u,{type:"primary",onClick:U},{default:a(()=>[t(n,null,{default:a(()=>[t(w(H))]),_:1}),e[9]||(e[9]=s(" 导出报告 ",-1))]),_:1,__:[9]})]),_:1})]),_:1})]),_:1}),t(M,{gutter:20,style:{"margin-bottom":"20px"}},{default:a(()=>[t(p,{span:6},{default:a(()=>[t(i,{shadow:"hover"},{default:a(()=>[t(h,{title:"总调用次数",value:T.value.totalCalls},{suffix:a(()=>e[10]||(e[10]=[s("次",-1)])),_:1},8,["value"]),o("div",pe,[t(n,{color:"#67c23a"},{default:a(()=>[t(w(E))]),_:1}),e[11]||(e[11]=o("span",{style:{color:"#67c23a"}},"+12.5%",-1)),e[12]||(e[12]=o("span",{style:{color:"#909399","margin-left":"4px"}},"较上周期",-1))])]),_:1})]),_:1}),t(p,{span:6},{default:a(()=>[t(i,{shadow:"hover"},{default:a(()=>[t(h,{title:"活跃用户数",value:T.value.activeUsers},{suffix:a(()=>e[13]||(e[13]=[s("人",-1)])),_:1},8,["value"]),o("div",ce,[t(n,{color:"#67c23a"},{default:a(()=>[t(w(E))]),_:1}),e[14]||(e[14]=o("span",{style:{color:"#67c23a"}},"+8.3%",-1)),e[15]||(e[15]=o("span",{style:{color:"#909399","margin-left":"4px"}},"较上周期",-1))])]),_:1})]),_:1}),t(p,{span:6},{default:a(()=>[t(i,{shadow:"hover"},{default:a(()=>[t(h,{title:"总Token消耗",value:T.value.totalTokens},{suffix:a(()=>e[16]||(e[16]=[s("M",-1)])),_:1},8,["value"]),o("div",me,[t(n,{color:"#67c23a"},{default:a(()=>[t(w(E))]),_:1}),e[17]||(e[17]=o("span",{style:{color:"#67c23a"}},"+18.7%",-1)),e[18]||(e[18]=o("span",{style:{color:"#909399","margin-left":"4px"}},"较上周期",-1))])]),_:1})]),_:1}),t(p,{span:6},{default:a(()=>[t(i,{shadow:"hover"},{default:a(()=>[t(h,{title:"营收金额",value:T.value.revenue,precision:2},{prefix:a(()=>e[19]||(e[19]=[s("¥",-1)])),_:1},8,["value"]),o("div",fe,[t(n,{color:"#67c23a"},{default:a(()=>[t(w(E))]),_:1}),e[20]||(e[20]=o("span",{style:{color:"#67c23a"}},"+15.2%",-1)),e[21]||(e[21]=o("span",{style:{color:"#909399","margin-left":"4px"}},"较上周期",-1))])]),_:1})]),_:1})]),_:1}),t(M,{gutter:20,style:{"margin-bottom":"20px"}},{default:a(()=>[t(p,{span:12},{default:a(()=>[t(i,null,{header:a(()=>e[22]||(e[22]=[o("div",{class:"card-header"},[o("span",{class:"title"},"API调用趋势")],-1)])),default:a(()=>[o("div",{ref_key:"callTrendChartRef",ref:L,style:{width:"100%",height:"300px"}},null,512)]),_:1})]),_:1}),t(p,{span:12},{default:a(()=>[t(i,null,{header:a(()=>e[23]||(e[23]=[o("div",{class:"card-header"},[o("span",{class:"title"},"Token消耗趋势")],-1)])),default:a(()=>[o("div",{ref_key:"tokenTrendChartRef",ref:S,style:{width:"100%",height:"300px"}},null,512)]),_:1})]),_:1})]),_:1}),t(M,{gutter:20,style:{"margin-bottom":"20px"}},{default:a(()=>[t(p,{span:12},{default:a(()=>[t(i,null,{header:a(()=>e[24]||(e[24]=[o("div",{class:"card-header"},[o("span",{class:"title"},"服务调用占比")],-1)])),default:a(()=>[o("div",{ref_key:"serviceDistChartRef",ref:D,style:{width:"100%",height:"300px"}},null,512)]),_:1})]),_:1}),t(p,{span:12},{default:a(()=>[t(i,null,{header:a(()=>e[25]||(e[25]=[o("div",{class:"card-header"},[o("span",{class:"title"},"成本分析")],-1)])),default:a(()=>[o("div",{ref_key:"costAnalysisChartRef",ref:F,style:{width:"100%",height:"300px"}},null,512)]),_:1})]),_:1})]),_:1}),t(i,null,{header:a(()=>e[26]||(e[26]=[o("div",{class:"card-header"},[o("span",{class:"title"},"服务详细统计")],-1)])),default:a(()=>[t(I,{data:A.value,border:"",style:{width:"100%"}},{default:a(()=>[t(d,{prop:"serviceName",label:"服务名称",width:"200"}),t(d,{prop:"calls",label:"调用次数",width:"120",align:"right",sortable:""},{default:a(({row:l})=>[s(c(l.calls.toLocaleString()),1)]),_:1}),t(d,{prop:"successRate",label:"成功率",width:"100",align:"center",sortable:""},{default:a(({row:l})=>[t(V,{type:l.successRate>=99?"success":l.successRate>=95?"warning":"danger"},{default:a(()=>[s(c(l.successRate)+"% ",1)]),_:2},1032,["type"])]),_:1}),t(d,{prop:"avgLatency",label:"平均延迟(ms)",width:"130",align:"right",sortable:""}),t(d,{prop:"inputTokens",label:"输入Tokens",width:"130",align:"right",sortable:""},{default:a(({row:l})=>[s(c((l.inputTokens/1e6).toFixed(2))+"M ",1)]),_:1}),t(d,{prop:"outputTokens",label:"输出Tokens",width:"130",align:"right",sortable:""},{default:a(({row:l})=>[s(c((l.outputTokens/1e6).toFixed(2))+"M ",1)]),_:1}),t(d,{prop:"totalTokens",label:"总Tokens",width:"130",align:"right",sortable:""},{default:a(({row:l})=>[s(c((l.totalTokens/1e6).toFixed(2))+"M ",1)]),_:1}),t(d,{prop:"cost",label:"成本(¥)",width:"120",align:"right",sortable:""},{default:a(({row:l})=>[s(" ¥"+c(l.cost.toLocaleString()),1)]),_:1}),t(d,{prop:"revenue",label:"营收(¥)",width:"120",align:"right",sortable:""},{default:a(({row:l})=>[s(" ¥"+c(l.revenue.toLocaleString()),1)]),_:1}),t(d,{label:"毛利率",width:"100",align:"center"},{default:a(({row:l})=>[o("span",{style:J({color:j(l.margin)})},c(l.margin)+"%",5)]),_:1})]),_:1},8,["data"])]),_:1})])}}}),je=K(ge,[["__scopeId","data-v-0f9f7144"]]);export{je as default};
