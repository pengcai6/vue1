import{d as b,r as v,j as V,c as S,a as t,w as o,o as x,b as c,E as y,e as C,k as I,i as _,l as N,u as k}from"./index-BX2sZVyW.js";import{E as w}from"./card-B6phTZGW.js";import{E as T,a as J}from"./form-item-BCUJoI1X.js";import{E as O}from"./button-Cn9gqGCu.js";import{E as B}from"./upload-dE4C5nPJ.js";import"./progress-B1_RPwJG.js";import{E as U}from"./input-5aB7ALv6.js";import"./event-BORzi4vc.js";import"./_baseClone-BOpOh07B.js";import"./index-PwB6y63X.js";import"./isEqual-ohjdCfDM.js";const $={class:"create-version-page p-5"},P=b({__name:"create-version",setup(F){const f=k(),s=v(null),n=v({version:"",description:""});function g(){if(!s.value)return;const i=`dataset_versions_${s.value.id}`,e=localStorage.getItem(i);let l=e?JSON.parse(e):[];l.length===0&&s.value.id==="ds-001"&&(l=[{version:"v1.2",description:"增加500条新数据",status:"ready",dataCount:10500,createTime:"2024-01-15 10:00:00"},{version:"v1.1",description:"修复数据格式问题",status:"ready",dataCount:1e4,createTime:"2024-01-12 14:00:00"},{version:"v1.0",description:"初始版本",status:"ready",dataCount:1e4,createTime:"2024-01-10 10:00:00"}]);const r={version:n.value.version,description:n.value.description,status:"ready",dataCount:s.value.dataCount||0,createTime:new Date().toLocaleString()};l.unshift(r),localStorage.setItem(i,JSON.stringify(l));const m=localStorage.getItem("datasets");if(m){const d=JSON.parse(m),u=d.findIndex(p=>p.id===s.value.id);u!==-1&&(d[u].latestVersion=n.value.version,localStorage.setItem("datasets",JSON.stringify(d)))}N.success("数据集版本创建成功"),setTimeout(()=>{f.back()},1e3)}return V(()=>{const i=localStorage.getItem("current-dataset");s.value=i?JSON.parse(i):null}),(i,e)=>{const l=U,r=J,m=y,d=B,u=O,p=T,E=w;return x(),S("div",$,[t(E,null,{default:o(()=>[e[6]||(e[6]=c("h2",{class:"text-2xl font-bold mb-4"},"新建数据集版本",-1)),t(p,{model:n.value,"label-width":"120px"},{default:o(()=>[t(r,{label:"数据集名称"},{default:o(()=>{var a;return[t(l,{value:(a=s.value)==null?void 0:a.name,disabled:""},null,8,["value"])]}),_:1}),t(r,{label:"当前版本"},{default:o(()=>{var a;return[t(l,{value:(a=s.value)==null?void 0:a.latestVersion,disabled:""},null,8,["value"])]}),_:1}),t(r,{label:"新版本号"},{default:o(()=>[t(l,{modelValue:n.value.version,"onUpdate:modelValue":e[0]||(e[0]=a=>n.value.version=a),placeholder:"例如: v1.3"},null,8,["modelValue"])]),_:1}),t(r,{label:"版本描述"},{default:o(()=>[t(l,{modelValue:n.value.description,"onUpdate:modelValue":e[1]||(e[1]=a=>n.value.description=a),type:"textarea",rows:3},null,8,["modelValue"])]),_:1}),t(r,{label:"上传文件"},{default:o(()=>[t(d,{drag:"",action:"#","auto-upload":!1},{default:o(()=>[t(m,{class:"el-icon--upload"},{default:o(()=>[t(C(I))]),_:1}),e[3]||(e[3]=c("div",{class:"el-upload__text"},[_("将文件拖到此处，或"),c("em",null,"点击上传")],-1))]),_:1,__:[3]})]),_:1}),t(r,null,{default:o(()=>[t(u,{type:"primary",onClick:g},{default:o(()=>e[4]||(e[4]=[_(" 创建版本 ",-1)])),_:1,__:[4]}),t(u,{onClick:e[2]||(e[2]=a=>i.$router.back())},{default:o(()=>e[5]||(e[5]=[_(" 取消 ",-1)])),_:1,__:[5]})]),_:1})]),_:1},8,["model"])]),_:1,__:[6]})])}}});export{P as default};
